
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Aviatrix Cloud Firewall Lab &#8212; ACE Security</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=1d85937c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'docs/egress';</script>
    <link rel="icon" href="../_static/aviatrix-favicon-32.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Quiz and Survey" href="quiz.html" />
    <link rel="prev" title="POD Portal" href="pod.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="home.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/Aviatrix_Logo_White_Gradient_RGB.svg" class="logo__image only-light" alt="ACE Security - Home"/>
    <script>document.write(`<img src="../_static/Aviatrix_Logo_White_Gradient_RGB.svg" class="logo__image only-dark" alt="ACE Security - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="home.html">
                    ACE Security Specialty
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="pod.html">POD Portal</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Aviatrix Cloud Firewall Lab</a></li>
<li class="toctree-l1"><a class="reference internal" href="quiz.html">Quiz and Survey</a></li>
<li class="toctree-l1"><a class="reference internal" href="quiz-hints.html">Quiz - Hints</a></li>
<li class="toctree-l1"><a class="reference internal" href="summary.html">Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="PDFs.html">PDFs</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/docs/egress.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Aviatrix Cloud Firewall Lab</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#initial-scenario">1. Initial Scenario</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#csp-native-nat-gateway-limitations">1.1 CSP Native NAT Gateway Limitations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-exfiltration-attack">2. Data Exfiltration Attack</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#you-are-the-newly-hired-cloud-networking-architect">2.1 You are the Newly Hired Cloud Networking Architect</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ztna-and-the-allowed-domains">3. ZTNA and the allowed domains</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aviatrix-copilot">4. Aviatrix CoPilot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lab-objectives">5. Lab Objectives</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deploy-the-aviatrix-spoke-gateway">5.1 Deploy the Aviatrix Spoke Gateway</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-the-webgroups">5.2 Create the WebGroups</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-an-editable-explicitdenyall-rule-above-the-greenfield-rule">5.3 Create an “editable” ExplicitDenyAll rule above the Greenfield-Rule</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-smartgroup-to-classify-traffic-passing-through-the-private-subnets">5.4 Create a SmartGroup to classify traffic passing through the private subnets</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#enable-the-local-egress-on-the-egress-vpc-vpc">5.5 Enable the Local Egress on the egress-vpc VPC</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-dcf-rule-that-permits-http-traffic-from-any-private-subnets-using-the-corresponding-webgroup">5.6 Create a DCF rule that permits HTTP traffic from any private subnets, using the corresponding WebGroup</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-dcf-rule-that-permits-https-traffic-from-any-private-subnets-using-the-corresponding-webgroup">5.7 Create a DCF rule that permits HTTPs traffic from any private subnets, using the corresponding WebGroup</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verify-that-the-monitor-section-in-the-egress-area-is-effectively-protecting-the-private-subnet">5.8 Verify that the Monitor section in the Egress area is effectively protecting the private subnet</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">6. Conclusion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lab-resolution">7. Lab Resolution</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#task-5-1-resolution">Task 5.1 resolution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#task-5-2-resolution">Task 5.2 resolution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#task-5-3-resolution">Task 5.3 resolution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#task-5-4-resolution">Task 5.4 resolution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#task-5-5-resolution">Task 5.5 resolution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#task-5-6-resolution">Task 5.6 resolution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#task-5-7-resolution">Task 5.7 resolution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#task-5-8-resolution">Task 5.8 resolution</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="aviatrix-cloud-firewall-lab">
<h1>Aviatrix Cloud Firewall Lab<a class="headerlink" href="#aviatrix-cloud-firewall-lab" title="Link to this heading">#</a></h1>
<section id="initial-scenario">
<h2>1. Initial Scenario<a class="headerlink" href="#initial-scenario" title="Link to this heading">#</a></h2>
<p>ABC Healthcare (a fictitious company), a leading healthcare provider, operates exclusively within the AWS cloud environment. For internet egress traffic, they utilize AWS NAT Gateway. While the NAT Gateway effectively handles IP address translation, it is not intended to serve as a comprehensive security solution. This limited security capability has raised concerns among ABC Healthcare’s management regarding data privacy and HIPAA compliance.</p>
<section id="csp-native-nat-gateway-limitations">
<h3>1.1 CSP Native NAT Gateway Limitations<a class="headerlink" href="#csp-native-nat-gateway-limitations" title="Link to this heading">#</a></h3>
<p>The current AWS NAT Gateway doesn’t provide the necessary visibility and logging capabilities, and it’s also very expensive due to 2 cents per GB egress data processing charges. ABC Healthcare’s average monthly egress traffic is around 500 TB.
The native solution also lacks visibility, is cost-prohibitive, and doesn’t support zero trust architecture—putting sensitive patient data and the healthcare provider’s reputation at risk.</p>
</section>
</section>
<section id="data-exfiltration-attack">
<h2>2. Data Exfiltration Attack<a class="headerlink" href="#data-exfiltration-attack" title="Link to this heading">#</a></h2>
<p>To add to the challenges, ABC Healthcare recently experienced a data exfiltration attack, causing substantial disruptions, reputational harm, and a decline in its stock value. As a consequence, the company dismissed its previous cloud network architects.</p>
<section id="you-are-the-newly-hired-cloud-networking-architect">
<h3>2.1 You are the Newly Hired Cloud Networking Architect<a class="headerlink" href="#you-are-the-newly-hired-cloud-networking-architect" title="Link to this heading">#</a></h3>
<p>As the newly appointed architect, your task is to secure this traffic using the <code class="docutils literal notranslate"><span class="pre">Aviatrix</span> <span class="pre">Cloud</span> <span class="pre">Firewall</span></code> service. Your objective is to implement a solution that enhances visibility, offers comprehensive logging, and complies with regulatory requirements—all while being cost-effective and efficient.</p>
</section>
</section>
<section id="ztna-and-the-allowed-domains">
<h2>3. ZTNA and the allowed domains<a class="headerlink" href="#ztna-and-the-allowed-domains" title="Link to this heading">#</a></h2>
<p>Your responsibility is to conduct a POC/POV in your lab environment and demonstrate how your company can leverage the Aviatrix Cloud Perimeter Solution to address this pain point. You should deploy the Aviatrix Secure Egress solution using the Aviatrix Spoke Gateway to protect internet-bound traffic more effectively than the AWS NAT Gateway.</p>
<p><ins>The Zero Trust policy should allow only the specified domains and block all other FQDNs</ins>.</p>
<p>Please note that the lab provides only some of the steps needed to complete this exercise. If you encounter any difficulties, you are encouraged to consult the documentation at <a href="https://docs.aviatrix.com" target="_blank">docs.aviatrix.com</a>.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">allowed-internet-http</span></code> domains</p>
<ul>
<li><p>*.ubuntu.com</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">allowed-internet-https</span></code> domains</p>
<ul>
<li><p>*.alibabacloud.com</p></li>
<li><p><a class="reference external" href="http://azure.microsoft.com">azure.microsoft.com</a></p></li>
<li><p><a class="reference external" href="http://aws.amazon.com">aws.amazon.com</a></p></li>
<li><p>*.amazonaws.com</p></li>
<li><p>*.aviatrix.com</p></li>
<li><p><a class="reference external" href="http://aviatrix.com">aviatrix.com</a></p></li>
<li><p><a class="reference external" href="http://cloud.google.com">cloud.google.com</a></p></li>
<li><p>*.docker.com</p></li>
<li><p>*.docker.io</p></li>
<li><p><a class="reference external" href="http://www.oracle.com">www.oracle.com</a></p></li>
</ul>
</li>
</ul>
</section>
<section id="aviatrix-copilot">
<h2>4. Aviatrix CoPilot<a class="headerlink" href="#aviatrix-copilot" title="Link to this heading">#</a></h2>
<p>Now, let’s access the Aviatrix Centralized Management Node, the <strong>CoPilot</strong>.</p>
<p>Navigate to your POD portal, click on the <code class="docutils literal notranslate"><span class="pre">&quot;Copilot&quot;</span></code> button, and enter your credentials.</p>
<figure class="align-center" id="id1">
<a class="reference internal image-reference" href="../_images/lab-egress01.png"><img alt="../_images/lab-egress01.png" src="../_images/lab-egress01.png" style="height: 300px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 2 </span><span class="caption-text">POD Portal</span><a class="headerlink" href="#id1" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id2">
<a class="reference internal image-reference" href="../_images/lab-egress02.png"><img alt="../_images/lab-egress02.png" src="../_images/lab-egress02.png" style="height: 400px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 3 </span><span class="caption-text">CoPilot UI - Welcome page</span><a class="headerlink" href="#id2" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The CoPilot <em>Dashboard</em> should look something like this:</p>
<figure class="align-center" id="id3">
<a class="reference internal image-reference" href="../_images/lab-egress03.png"><img alt="../_images/lab-egress03.png" src="../_images/lab-egress03.png" style="height: 400px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 4 </span><span class="caption-text">Dashboard</span><a class="headerlink" href="#id3" title="Link to this image">#</a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>Before you begin building your multicloud infrastructure, please adjust the <strong>fetch timers</strong> in CoPilot.</p></li>
</ul>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Navigate to <strong>CoPilot &gt; Settings &gt; Resources &gt; Task Server</strong></p>
</div>
<p>Set the intervals for <code class="docutils literal notranslate"><span class="pre">Fetch</span> <span class="pre">GW</span> <span class="pre">Routes</span></code> and <code class="docutils literal notranslate"><span class="pre">Fetch</span> <span class="pre">VPC</span> <span class="pre">Routes</span></code> to <strong>“1 Second”</strong> each, then click on <strong>SAVE</strong>.</p>
<figure class="align-center" id="id4">
<a class="reference internal image-reference" href="../_images/lab-egress04.png"><img alt="../_images/lab-egress04.png" src="../_images/lab-egress04.png" style="height: 400px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 5 </span><span class="caption-text">Task Server</span><a class="headerlink" href="#id4" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>The order of the <strong><em>Task Servers</em></strong> on the screenshot above might be different on your CoPilot</p>
</div>
<figure class="align-center" id="id5">
<img alt="../_images/lab-egress05.png" src="../_images/lab-egress05.png" />
<figcaption>
<p><span class="caption-number">Fig. 6 </span><span class="caption-text">Fetch GW Routes</span><a class="headerlink" href="#id5" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id6">
<img alt="../_images/lab-egress06.png" src="../_images/lab-egress06.png" />
<figcaption>
<p><span class="caption-number">Fig. 7 </span><span class="caption-text">Fetch VPC Routes</span><a class="headerlink" href="#id6" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>After that, click on <strong>Commit</strong>.</p>
<figure class="align-center" id="id7">
<a class="reference internal image-reference" href="../_images/lab-egress07.png"><img alt="../_images/lab-egress07.png" src="../_images/lab-egress07.png" style="height: 400px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 8 </span><span class="caption-text">Commit</span><a class="headerlink" href="#id7" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These are very aggressive settings. In a Production environment, you should not set these intervals that frequently!</p>
</div>
</section>
<section id="lab-objectives">
<h2>5. Lab Objectives<a class="headerlink" href="#lab-objectives" title="Link to this heading">#</a></h2>
<p>These are the requirements for this hands-on activity. Please follow each step carefully. However, if you get stuck, feel free to jump to <strong><em>Section #7</em></strong> for a thorough solution.</p>
<section id="deploy-the-aviatrix-spoke-gateway">
<h3>5.1 Deploy the Aviatrix Spoke Gateway<a class="headerlink" href="#deploy-the-aviatrix-spoke-gateway" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Create a single Aviatrix Spoke Gateway in the AWS <strong>us-east-1</strong> region within the VPC named <code class="docutils literal notranslate"><span class="pre">“egress-vpc”</span></code>. You may assign any name you prefer.</p></li>
<li><p>The Spoke Gateway instance size should be <strong>t3a.small</strong>.</p></li>
<li><p>The Spoke gateway must be attached to the <strong>egress-vpc-public-us-east-1a</strong> subnet</p></li>
</ul>
</section>
<section id="create-the-webgroups">
<h3>5.2 Create the WebGroups<a class="headerlink" href="#create-the-webgroups" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Create <strong>two</strong> WebGroups that match the domains listed on <strong><em>Section #3</em></strong>.</p></li>
</ul>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>The WebGroup section will become enabled and visible in CoPilot once you activate the <strong>Distributed Cloud Firewall</strong> service (i.e., the Aviatrix Cloud Firewall).</p>
</div>
</section>
<section id="create-an-editable-explicitdenyall-rule-above-the-greenfield-rule">
<h3>5.3 Create an “editable” ExplicitDenyAll rule above the Greenfield-Rule<a class="headerlink" href="#create-an-editable-explicitdenyall-rule-above-the-greenfield-rule" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Create a rule named <strong>ExplicitDenyAll</strong>.</p></li>
<li><p>Enable <strong>Logging</strong> for the rule</p></li>
<li><p>Position the rule <strong>above</strong> <em>Greenfield-Rule</em></p></li>
</ul>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>The pre-defined ExplicitDenyAll rule is not editable; therefore, logging cannot be activated for it!</p>
</div>
</section>
<section id="create-a-smartgroup-to-classify-traffic-passing-through-the-private-subnets">
<h3>5.4 Create a SmartGroup to classify traffic passing through the private subnets<a class="headerlink" href="#create-a-smartgroup-to-classify-traffic-passing-through-the-private-subnets" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>You need to create a SmartGroup that includes all EAST-WEST traffic.</p></li>
</ul>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Use the RFC1918 routes!</p>
</div>
</section>
<section id="enable-the-local-egress-on-the-egress-vpc-vpc">
<h3>5.5 Enable the Local Egress on the egress-vpc VPC<a class="headerlink" href="#enable-the-local-egress-on-the-egress-vpc-vpc" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Activate the <code class="docutils literal notranslate"><span class="pre">local</span> <span class="pre">egress</span></code> service so that any private routing tables within the <em>egress-vpc</em> will receive a default route pointing to the Spoke Gateway.</p></li>
</ul>
</section>
<section id="create-a-dcf-rule-that-permits-http-traffic-from-any-private-subnets-using-the-corresponding-webgroup">
<h3>5.6 Create a DCF rule that permits HTTP traffic from any private subnets, using the corresponding WebGroup<a class="headerlink" href="#create-a-dcf-rule-that-permits-http-traffic-from-any-private-subnets-using-the-corresponding-webgroup" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>This Distributed Cloud Firewall rule should exclusively allow <strong>HTTP</strong> traffic originating from any subnets linked to a private routing table to access the internet, specifically targeting the domains listed in the <em>allowed-internet-http</em> WebGroup.</p></li>
</ul>
</section>
<section id="create-a-dcf-rule-that-permits-https-traffic-from-any-private-subnets-using-the-corresponding-webgroup">
<h3>5.7 Create a DCF rule that permits HTTPs traffic from any private subnets, using the corresponding WebGroup<a class="headerlink" href="#create-a-dcf-rule-that-permits-https-traffic-from-any-private-subnets-using-the-corresponding-webgroup" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>This Distributed Cloud Firewall rule should exclusively allow <strong>HTTPS</strong> traffic originating from any subnets linked to a private routing table to access the internet, specifically targeting the domains listed in the <em>allowed-internet-https</em> WebGroup.</p></li>
</ul>
</section>
<section id="verify-that-the-monitor-section-in-the-egress-area-is-effectively-protecting-the-private-subnet">
<h3>5.8 Verify that the Monitor section in the Egress area is effectively protecting the private subnet<a class="headerlink" href="#verify-that-the-monitor-section-in-the-egress-area-is-effectively-protecting-the-private-subnet" title="Link to this heading">#</a></h3>
</section>
</section>
<section id="conclusion">
<h2>6. Conclusion<a class="headerlink" href="#conclusion" title="Link to this heading">#</a></h2>
<p>By implementing the <code class="docutils literal notranslate"><span class="pre">Aviatrix</span> <span class="pre">Cloud</span> <span class="pre">Firewall</span></code>, our healthcare provider enhanced their security posture, reduced costs, and closed visibility gaps previously associated with the AWS NAT Gateway. Patient data remains protected, and the provider’s reputation is preserved.</p>
<p>Remember, <code class="docutils literal notranslate"><span class="pre">Aviatrix</span> <span class="pre">Cloud</span> <span class="pre">Firewall</span></code> is your trusted solution for secure and cost-effective management of internet-bound traffic.</p>
</section>
<section id="lab-resolution">
<h2>7. Lab Resolution<a class="headerlink" href="#lab-resolution" title="Link to this heading">#</a></h2>
<details>
  <summary>
Click here to view the complete walkthrough for the lab resolution: <span style='color:#33ECFF'>[disclose the RESOLUTION]</span></summary>
<section id="task-5-1-resolution">
<h3>Task 5.1 resolution<a class="headerlink" href="#task-5-1-resolution" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Navigate to <strong>CoPilot &gt; Cloud Fabric &gt; Gateways &gt; Spoke Gateway</strong>, then click on the <code class="docutils literal notranslate"><span class="pre">&quot;+</span> <span class="pre">Spoke</span> <span class="pre">Gateway&quot;</span></code> button.</p></li>
</ul>
<p>Make sure these parameters are entered in the <code class="docutils literal notranslate"><span class="pre">&quot;Create</span> <span class="pre">Spoke</span> <span class="pre">Gateway&quot;</span></code> pop-up window.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You need to deploy one single instance!</p>
</div>
<ul class="simple">
<li><p><strong>Name:</strong> <span style='color:#479608'>Choose your favorite name</span></p></li>
<li><p><strong>Cloud:</strong> <span style='color:#479608'>AWS (Standard)</span></p></li>
<li><p><strong>Account:</strong> <span style='color:#479608'>aws-account</span></p></li>
<li><p><strong>Region:</strong> <span style='color:#479608'>us-east-1 (N. Virginia)</span></p></li>
<li><p><strong>VPC ID:</strong> <span style='color:#479608'>egress-vpc</span></p></li>
<li><p><strong>Instance Size:</strong> <span style='color:#479608'>t3a.small</span></p></li>
<li><p><strong>High Performance Encryption:</strong> <span style='color:#479608'><strong>Off</strong></span></p></li>
<li><p><strong>Attach to Subnet:</strong> <span style='color:#479608'>10.1.2.32/28 - egress-vpc-public-us-east-1a</span></p></li>
<li><p><strong>Public IP:</strong> <span style='color:#479608'>Allocate New Static Public IP</span></p></li>
</ul>
<p>Click <strong>Save</strong>.</p>
<figure class="align-center" id="id8">
<img alt="../_images/lab-resegress01.png" src="../_images/lab-resegress01.png" />
<figcaption>
<p><span class="caption-number">Fig. 9 </span><span class="caption-text">Create Spoke Gateway in AWS</span><a class="headerlink" href="#id8" title="Link to this image">#</a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>Now, review the Dynamic Topology by navigating to <strong>CoPilot &gt; Cloud Fabric &gt; Topology</strong>. Here, you can see how the topology will appear after the Gateway deployment. Please keep in mind that it may take a few additional minutes for the changes to be reflected, so kindly be patient.</p></li>
</ul>
<figure class="align-center" id="id9">
<img alt="../_images/lab-resegress02.png" src="../_images/lab-resegress02.png" />
<figcaption>
<p><span class="caption-number">Fig. 10 </span><span class="caption-text">height: 400px
Topology</span><a class="headerlink" href="#id9" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>If you do not visualize the same topology, do not forget to click on the <code class="docutils literal notranslate"><span class="pre">&quot;Managed&quot;</span></code> button, to keeping hidden the <em>Unmanaged</em> VPCs.</p>
<figure class="align-center" id="id10">
<a class="reference internal image-reference" href="../_images/lab-resegress03.png"><img alt="../_images/lab-resegress03.png" src="../_images/lab-resegress03.png" style="height: 400px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 11 </span><span class="caption-text">Managed VPCs</span><a class="headerlink" href="#id10" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
</section>
<section id="task-5-2-resolution">
<h3>Task 5.2 resolution<a class="headerlink" href="#task-5-2-resolution" title="Link to this heading">#</a></h3>
<p>This task includes an important tip: you must first activate the DCF service before proceeding with the creation of WebGroups.</p>
<ul class="simple">
<li><p>Navigate to <strong>CoPilot &gt; Security &gt; Distributed Cloud Firewall &gt; Rules</strong> and click on <code class="docutils literal notranslate"><span class="pre">&quot;Enable</span> <span class="pre">Distributed</span> <span class="pre">Cloud</span> <span class="pre">Firewall&quot;</span></code>.
Then, click on <code class="docutils literal notranslate"><span class="pre">&quot;Begin&quot;</span></code>.</p></li>
</ul>
<figure class="align-center" id="id11">
<img alt="../_images/lab-resegress04.png" src="../_images/lab-resegress04.png" />
<figcaption>
<p><span class="caption-number">Fig. 12 </span><span class="caption-text">Begin using Distributed Cloud Firewall</span><a class="headerlink" href="#id11" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id12">
<img alt="../_images/lab-resegress05.png" src="../_images/lab-resegress05.png" />
<figcaption>
<p><span class="caption-number">Fig. 13 </span><span class="caption-text">Begin</span><a class="headerlink" href="#id12" title="Link to this image">#</a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>Navigate to <strong>CoPilot &gt; Groups &gt; WebGroups</strong> and click on the <code class="docutils literal notranslate"><span class="pre">&quot;+</span> <span class="pre">WebGroup&quot;</span></code> button.</p></li>
</ul>
<figure class="align-center" id="id13">
<a class="reference internal image-reference" href="../_images/lab-resegress06.png"><img alt="../_images/lab-resegress06.png" src="../_images/lab-resegress06.png" style="height: 400px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 14 </span><span class="caption-text">Begin</span><a class="headerlink" href="#id13" title="Link to this image">#</a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>Create the first <strong><em>WebGroup</em></strong> with the following parameters:</p>
<ul>
<li><p><strong>Name</strong>: <span style='color:#479608'>allowed-internet-http</span></p></li>
<li><p><strong>Type</strong>: <span style='color:#479608'>Domains</span></p></li>
<li><p><strong>Domains/URLs</strong>: <span style='color:#479608'>*.ubuntu.com</span></p></li>
</ul>
</li>
</ul>
<p>Do not forget to click on <strong>Save</strong>.</p>
<figure class="align-center" id="id14">
<img alt="../_images/lab-resegress07.png" src="../_images/lab-resegress07.png" />
<figcaption>
<p><span class="caption-number">Fig. 15 </span><span class="caption-text">WebGroup creation</span><a class="headerlink" href="#id14" title="Link to this image">#</a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>Let’s proceed to create the second <strong><em>WebGroup</em></strong> using the following parameters:</p>
<ul>
<li><p><strong>Name</strong>: <span style='color:#479608'>allowed-internet-https</span></p></li>
<li><p><strong>Type</strong>: <span style='color:#479608'>Domains</span></p></li>
<li><p><strong>Domains/URLs</strong>: <span style='color:#479608'>*.alibabacloud.com</span></p></li>
<li><p><strong>Domains/URLs</strong>: <span style='color:#479608'>azure.microsoft.com</span></p></li>
<li><p><strong>Domains/URLs</strong>: <span style='color:#479608'>aws.amazon.com</span></p></li>
<li><p><strong>Domains/URLs</strong>: <span style='color:#479608'>*.amazonaws.com</span></p></li>
<li><p><strong>Domains/URLs</strong>: <span style='color:#479608'>*.aviatrix.com</span></p></li>
<li><p><strong>Domains/URLs</strong>: <span style='color:#479608'>aviatrix.com</span></p></li>
<li><p><strong>Domains/URLs</strong>: <span style='color:#479608'>cloud.google.com</span></p></li>
<li><p><strong>Domains/URLs</strong>: <span style='color:#479608'>*.docker.com</span></p></li>
<li><p><strong>Domains/URLs</strong>: <span style='color:#479608'>*.docker.io</span></p></li>
<li><p><strong>Domains/URLs</strong>: <span style='color:#479608'><a class="reference external" href="http://www.oracle.com">www.oracle.com</a></span></p></li>
</ul>
</li>
</ul>
<p>Do not forget to click on <strong>Save</strong>.</p>
<figure class="align-center" id="id15">
<img alt="../_images/lab-resegress08.png" src="../_images/lab-resegress08.png" />
<figcaption>
<p><span class="caption-number">Fig. 16 </span><span class="caption-text">WebGroup #2</span><a class="headerlink" href="#id15" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id16">
<a class="reference internal image-reference" href="../_images/lab-resegress09.png"><img alt="../_images/lab-resegress09.png" src="../_images/lab-resegress09.png" style="height: 400px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 17 </span><span class="caption-text">WebGroup section</span><a class="headerlink" href="#id16" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="task-5-3-resolution">
<h3>Task 5.3 resolution<a class="headerlink" href="#task-5-3-resolution" title="Link to this heading">#</a></h3>
<p>Navigate to <strong>CoPilot &gt; Security &gt; Distributed Cloud Firewall &gt; Rules</strong> and click on the <code class="docutils literal notranslate"><span class="pre">&quot;+</span> <span class="pre">Rule&quot;</span></code> button.</p>
<figure class="align-center" id="id17">
<img alt="../_images/lab-resegress10.png" src="../_images/lab-resegress10.png" />
<figcaption>
<p><span class="caption-number">Fig. 18 </span><span class="caption-text">New Rule</span><a class="headerlink" href="#id17" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Insert the following parameters:</p>
<ul class="simple">
<li><p><strong>Name</strong>: <span style='color:#479608'>ExplicitDenyAll</span></p></li>
<li><p><strong>Source Smartgroups</strong>: <span style='color:#479608'>Anywhere(0.0.0.0/0)</span></p></li>
<li><p><strong>Destination Smartgroups</strong>: <span style='color:#479608'>Anywhere(0.0.0.0/0)</span></p></li>
<li><p><strong>Protocol</strong>: <span style='color:#479608'>Any</span></p></li>
<li><p><strong>Logging</strong>: <span style='color:#479608'>On</span></p></li>
<li><p><strong>Action</strong>: <span style='color:#479608'><strong>Deny</strong></span></p></li>
</ul>
<p>Do not forget to click on <strong>Save In Drafts</strong>.</p>
<figure class="align-center" id="id18">
<img alt="../_images/lab-resegress11.png" src="../_images/lab-resegress11.png" />
<figcaption>
<p><span class="caption-number">Fig. 19 </span><span class="caption-text">ExplicitDenyAll</span><a class="headerlink" href="#id18" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Do not forget to click on <strong>Commit</strong>.</p>
<figure class="align-center" id="id19">
<img alt="../_images/lab-resegress12.png" src="../_images/lab-resegress12.png" />
<figcaption>
<p><span class="caption-number">Fig. 20 </span><span class="caption-text">Commit</span><a class="headerlink" href="#id19" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="task-5-4-resolution">
<h3>Task 5.4 resolution<a class="headerlink" href="#task-5-4-resolution" title="Link to this heading">#</a></h3>
<p>This task requires you to create an ad-hoc SmartGroup, utilizing the three well-known <em>Summary Routes</em>:</p>
<ul class="simple">
<li><p>10.0.0.0/8</p></li>
<li><p>172.16.0.0/12</p></li>
<li><p>192.168.0.0/16</p></li>
<li><p>Navigate to <strong>CoPilot &gt; Groups &gt; SmartGroups</strong> and click on the <code class="docutils literal notranslate"><span class="pre">&quot;+</span> <span class="pre">SmartGroup&quot;</span></code> button.</p></li>
</ul>
<figure class="align-center" id="id20">
<a class="reference internal image-reference" href="../_images/lab-resegress13.png"><img alt="../_images/lab-resegress13.png" src="../_images/lab-resegress13.png" style="height: 400px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 21 </span><span class="caption-text">SmartGroup</span><a class="headerlink" href="#id20" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Now, click on the arrow icon  inside the <code class="docutils literal notranslate"><span class="pre">&quot;+</span> <span class="pre">Resource</span> <span class="pre">Type&quot;</span></code> button and select <code class="docutils literal notranslate"><span class="pre">&quot;IP</span> <span class="pre">/</span> <span class="pre">CIDRs&quot;</span></code>.</p>
<figure class="align-center" id="id21">
<a class="reference internal image-reference" href="../_images/lab-resegress14.png"><img alt="../_images/lab-resegress14.png" src="../_images/lab-resegress14.png" style="height: 400px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 22 </span><span class="caption-text">SmartGroup</span><a class="headerlink" href="#id21" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Ensure these parameters are entered in the pop-up window <code class="docutils literal notranslate"><span class="pre">&quot;Create</span> <span class="pre">SmartGroup&quot;</span></code>:</p>
<ul class="simple">
<li><p><strong>Name</strong>: <span style='color:#479608'>rfc1918</span></p></li>
<li><p><strong>IPs / CIDRs</strong>: <span style='color:#479608'>10.0.0.0/8</span></p></li>
<li><p><strong>IPs / CIDRs</strong>: <span style='color:#479608'>172.16.0.0/12</span></p></li>
<li><p><strong>IPs / CIDRs</strong>: <span style='color:#479608'>192.168.0.0/16</span></p></li>
</ul>
<p>Before clicking on <strong>SAVE</strong>, delete the empty <code class="docutils literal notranslate"><span class="pre">&quot;Virtual</span> <span class="pre">Machines&quot;</span></code> additional condition.</p>
<figure class="align-center" id="id22">
<a class="reference internal image-reference" href="../_images/lab-resegress15.png"><img alt="../_images/lab-resegress15.png" src="../_images/lab-resegress15.png" style="height: 400px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 23 </span><span class="caption-text">New SG</span><a class="headerlink" href="#id22" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id23">
<a class="reference internal image-reference" href="../_images/lab-resegress16.png"><img alt="../_images/lab-resegress16.png" src="../_images/lab-resegress16.png" style="height: 400px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 24 </span><span class="caption-text">SmartGroups section</span><a class="headerlink" href="#id23" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="task-5-5-resolution">
<h3>Task 5.5 resolution<a class="headerlink" href="#task-5-5-resolution" title="Link to this heading">#</a></h3>
<p>In this task, you are required to enable the <code class="docutils literal notranslate"><span class="pre">Local</span> <span class="pre">Egress</span></code>.</p>
<ul class="simple">
<li><p>Navigate to <strong>CoPilot &gt; Security &gt; Egress &gt; Egress VPC/VNets</strong> and click on the <code class="docutils literal notranslate"><span class="pre">&quot;Enable</span> <span class="pre">Local</span> <span class="pre">Egress</span> <span class="pre">on</span> <span class="pre">VPC/VNets&quot;</span></code> button.</p></li>
</ul>
<figure class="align-center" id="id24">
<a class="reference internal image-reference" href="../_images/lab-resegress17.png"><img alt="../_images/lab-resegress17.png" src="../_images/lab-resegress17.png" style="height: 400px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 25 </span><span class="caption-text">Egress</span><a class="headerlink" href="#id24" title="Link to this image">#</a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>Now, select the <em>egress-vpc</em> and then click on <strong>Add</strong>.</p></li>
</ul>
<figure class="align-center" id="id25">
<a class="reference internal image-reference" href="../_images/lab-resegress18.png"><img alt="../_images/lab-resegress18.png" src="../_images/lab-resegress18.png" style="height: 400px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 26 </span><span class="caption-text">egress-vpc with local Egress</span><a class="headerlink" href="#id25" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="task-5-6-resolution">
<h3>Task 5.6 resolution<a class="headerlink" href="#task-5-6-resolution" title="Link to this heading">#</a></h3>
<p>This task involves creating a Distributed Cloud Firewall rule and attaching the WebGroup you previously created.</p>
<ul class="simple">
<li><p>Navigate to <strong>CoPilot &gt; Security &gt; Distributed Cloud Firewall &gt; Rules</strong> and click on the <code class="docutils literal notranslate"><span class="pre">&quot;+</span> <span class="pre">Rule&quot;</span></code> button.</p></li>
</ul>
<figure class="align-center" id="id26">
<a class="reference internal image-reference" href="../_images/lab-resegress19.png"><img alt="../_images/lab-resegress19.png" src="../_images/lab-resegress19.png" style="height: 400px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 27 </span><span class="caption-text">+Rule</span><a class="headerlink" href="#id26" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Insert the following parameters:</p>
<ul class="simple">
<li><p><strong>Name</strong>: <span style='color:#479608'>Choose your favorite name</span></p></li>
<li><p><strong>Source Smartgroups</strong>: <span style='color:#479608'>rfc1918</span></p></li>
<li><p><strong>Destination Smartgroups</strong>: <span style='color:#479608'>Public Internet</span></p></li>
<li><p><strong>WebGroups</strong>: <span style='color:#479608'><strong>allowed-internet-http</strong></span></p></li>
<li><p><strong>Protocol</strong>: <span style='color:#479608'>TCP</span></p></li>
<li><p><strong>Port</strong>: <span style='color:#479608'>80</span></p></li>
<li><p><strong>Logging</strong>: <span style='color:#479608'><strong>On</strong></span></p></li>
<li><p><strong>Action</strong>: <span style='color:#479608'>Permit</span></p></li>
</ul>
<p>Do not forget to click on <strong>Save In Drafts</strong>.</p>
<figure class="align-center" id="id27">
<img alt="../_images/lab-resegress20.png" src="../_images/lab-resegress20.png" />
<figcaption>
<p><span class="caption-number">Fig. 28 </span><span class="caption-text">Saving the new Rule</span><a class="headerlink" href="#id27" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="task-5-7-resolution">
<h3>Task 5.7 resolution<a class="headerlink" href="#task-5-7-resolution" title="Link to this heading">#</a></h3>
<p>This task involves creating another Distributed Cloud Firewall rule and attaching the WebGroup you previously created.</p>
<ul class="simple">
<li><p>Before clicking the <strong>Commit</strong> button, click again the <code class="docutils literal notranslate"><span class="pre">&quot;+</span> <span class="pre">Rule&quot;</span></code> button.</p></li>
</ul>
<figure class="align-center" id="id28">
<a class="reference internal image-reference" href="../_images/lab-resegress21.png"><img alt="../_images/lab-resegress21.png" src="../_images/lab-resegress21.png" style="height: 400px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 29 </span><span class="caption-text">+Rule</span><a class="headerlink" href="#id28" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Insert the following parameters:</p>
<ul class="simple">
<li><p><strong>Name</strong>: <span style='color:#479608'>Choose your favorite name</span></p></li>
<li><p><strong>Source Smartgroups</strong>: <span style='color:#479608'>rfc1918</span></p></li>
<li><p><strong>Destination Smartgroups</strong>: <span style='color:#479608'>Public Internet</span></p></li>
<li><p><strong>WebGroups</strong>: <span style='color:#479608'><strong>allowed-internet-https</strong></span></p></li>
<li><p><strong>Protocol</strong>: <span style='color:#479608'>TCP</span></p></li>
<li><p><strong>Port</strong>: <span style='color:#479608'>443</span></p></li>
<li><p><strong>Logging</strong>: <span style='color:#479608'><strong>On</strong></span></p></li>
<li><p><strong>Action</strong>: <span style='color:#479608'>Permit</span></p></li>
</ul>
<p>Do not forget to click on <strong>Save In Drafts</strong>.</p>
<figure class="align-center" id="id29">
<img alt="../_images/lab-resegress22.png" src="../_images/lab-resegress22.png" />
<figcaption>
<p><span class="caption-number">Fig. 30 </span><span class="caption-text">Saving the new Rule</span><a class="headerlink" href="#id29" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Now you can click on <strong>Commit</strong>.**</p>
<figure class="align-center" id="id30">
<img alt="../_images/lab-resegress23.png" src="../_images/lab-resegress23.png" />
<figcaption>
<p><span class="caption-number">Fig. 31 </span><span class="caption-text">Commit</span><a class="headerlink" href="#id30" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="task-5-8-resolution">
<h3>Task 5.8 resolution<a class="headerlink" href="#task-5-8-resolution" title="Link to this heading">#</a></h3>
<p>This task involves creating another Distributed Cloud Firewall rule and attaching the WebGroup you previously created.</p>
</details></section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./docs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="pod.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">POD Portal</p>
      </div>
    </a>
    <a class="right-next"
       href="quiz.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Quiz and Survey</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#initial-scenario">1. Initial Scenario</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#csp-native-nat-gateway-limitations">1.1 CSP Native NAT Gateway Limitations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-exfiltration-attack">2. Data Exfiltration Attack</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#you-are-the-newly-hired-cloud-networking-architect">2.1 You are the Newly Hired Cloud Networking Architect</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ztna-and-the-allowed-domains">3. ZTNA and the allowed domains</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aviatrix-copilot">4. Aviatrix CoPilot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lab-objectives">5. Lab Objectives</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#deploy-the-aviatrix-spoke-gateway">5.1 Deploy the Aviatrix Spoke Gateway</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-the-webgroups">5.2 Create the WebGroups</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-an-editable-explicitdenyall-rule-above-the-greenfield-rule">5.3 Create an “editable” ExplicitDenyAll rule above the Greenfield-Rule</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-smartgroup-to-classify-traffic-passing-through-the-private-subnets">5.4 Create a SmartGroup to classify traffic passing through the private subnets</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#enable-the-local-egress-on-the-egress-vpc-vpc">5.5 Enable the Local Egress on the egress-vpc VPC</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-dcf-rule-that-permits-http-traffic-from-any-private-subnets-using-the-corresponding-webgroup">5.6 Create a DCF rule that permits HTTP traffic from any private subnets, using the corresponding WebGroup</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-dcf-rule-that-permits-https-traffic-from-any-private-subnets-using-the-corresponding-webgroup">5.7 Create a DCF rule that permits HTTPs traffic from any private subnets, using the corresponding WebGroup</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verify-that-the-monitor-section-in-the-egress-area-is-effectively-protecting-the-private-subnet">5.8 Verify that the Monitor section in the Egress area is effectively protecting the private subnet</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">6. Conclusion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lab-resolution">7. Lab Resolution</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#task-5-1-resolution">Task 5.1 resolution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#task-5-2-resolution">Task 5.2 resolution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#task-5-3-resolution">Task 5.3 resolution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#task-5-4-resolution">Task 5.4 resolution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#task-5-5-resolution">Task 5.5 resolution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#task-5-6-resolution">Task 5.6 resolution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#task-5-7-resolution">Task 5.7 resolution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#task-5-8-resolution">Task 5.8 resolution</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Aviatrix
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>