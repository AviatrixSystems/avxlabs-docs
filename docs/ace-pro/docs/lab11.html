
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Lab 11 - DISTRIBUTED CLOUD FIREWALL &#8212; ACE Operations Lab</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=1d85937c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'docs/lab11';</script>
    <link rel="icon" href="../_static/aviatrix-favicon-32.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Lab 12 - IAC &amp; NETWORK INSIGHTS API" href="lab12.html" />
    <link rel="prev" title="Lab 10 - COSTIQ" href="lab10.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="home.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/Aviatrix_Logo_White_Gradient_RGB.svg" class="logo__image only-light" alt="ACE Operations Lab - Home"/>
    <script>document.write(`<img src="../_static/Aviatrix_Logo_White_Gradient_RGB.svg" class="logo__image only-dark" alt="ACE Operations Lab - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="home.html">
                    Welcome to ACE Professional Lab
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="pod.html">POD Portal</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab1.html">Lab 1 - VPCs/VNets CREATION</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab2.html">Lab 2 - TRANSIT NETWORKING</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab3.html">Lab 3 - NETWORK SEGMENTATION</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab4.html">Lab 4 - HPE WITH ACTIVE MESH</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab5.html">Lab 5 - AVIATRIX CLOUD FIREWALL</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab6.html">Lab 6 - FIRENET</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab7.html">Lab 7 - SITE2CLOUD</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab8.html">Lab 8 - SECURE HIGH-PERFORMANCE DATACENTER EDGE</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab9.html">Lab 9 - THREAT PREVENTION</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab10.html">Lab 10 - COSTIQ</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Lab 11 - DISTRIBUTED CLOUD FIREWALL</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab12.html">Lab 12 - IAC &amp; NETWORK INSIGHTS API</a></li>
<li class="toctree-l1"><a class="reference internal" href="logos-icons.html">LOGOS-ICONS</a></li>
<li class="toctree-l1"><a class="reference internal" href="PDFs.html">PDFs</a></li>
<li class="toctree-l1"><a class="reference internal" href="CloudHeroes.html">CLOUD NETWORKING HEROES PROGRAM</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/docs/lab11.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Lab 11 - DISTRIBUTED CLOUD FIREWALL</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#objective">1. Objective</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#distributed-cloud-firewall-overview">2. Distributed Cloud Firewall Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#smart-groups-creation">3. Smart Groups Creation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#smart-group-bu1">3.1 Smart Group “bu1”</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#smart-group-bu2">3.2 Smart Group “bu2”</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#connectivity-verification-icmp-using-gatus-app">3.3 Connectivity Verification (ICMP) Using Gatus App</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#connectivity-verification-icmp-using-ssh-client-bonus">3.4 Connectivity Verification (ICMP) Using SSH Client <span style="color:#33ECFF">(BONUS)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#connectivity-verification-ssh-using-gatus-app">3.5 Connectivity Verification (SSH) Using Gatus App</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#connectivity-verification-ssh-using-ssh-client-bonus">3.6  Connectivity Verification (SSH) Using SSH Client <span style="color:#33ECFF">(BONUS)</span></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dcf-rules-creation">4. DCF Rules Creation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-an-intra-rule-that-allows-icmp-inside-bu1">4.1. Create an intra-rule that allows ICMP inside bu1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-an-intra-rule-that-allows-icmp-inside-bu2">4.2. Create an intra-rule that allows ICMP inside bu2</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#verification">5. Verification</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verify-icmp-within-bu1-and-from-bu1-towards-bu2-using-the-gatus-app">5.1 Verify ICMP within bu1 and from bu1 towards bu2 Using the Gatus App</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verify-ssh-traffic-from-your-laptop-to-bu1-using-ssh-client-bonus">5.2 Verify SSH traffic from your laptop to bu1 Using SSH Client <span style="color:#33ECFF">(BONUS)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verify-icmp-within-bu1-and-from-bu1-towards-bu2-using-the-ssh-client-bonus">5.3 Verify ICMP within bu1 and from bu1 towards bu2 Using the SSH Client <span style="color:#33ECFF">(BONUS)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sg-orchestration">5.4 SG Orchestration</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sg-orchestration-verification-using-the-gatus-app">5.5 SG Orchestration Verification Using the Gatus App</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sg-orchestration-verification-using-the-ssh-client-bonus">5.6 SG Orchestration Verification Using the SSH Client <span style="color:#33ECFF">(BONUS)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verify-ssh-within-bu1-using-the-gatus-app">5.7 Verify SSH within bu1 Using the Gatus App</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verify-ssh-within-bu1-using-the-ssh-client-bonus">5.8 Verify SSH within bu1 Using the SSH Client <span style="color:#33ECFF">(BONUS)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#add-a-rule-that-allows-ssh-in-bu1">5.9 Add a rule that allows SSH in bu1</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#verification-after-the-intra-rule">6. Verification after the intra-rule</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">6.1 Verify SSH within bu1 Using the Gatus App</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">6.2 Verify SSH within bu1 Using the SSH Client <span style="color:#33ECFF">(BONUS)</span></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#logs">7. Logs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#verification-inside-bu2">8.  Verification inside bu2</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verify-icmp-traffic-within-bu2-using-gatus-app">8.1 Verify ICMP traffic within bu2 Using Gatus App</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verify-icmp-traffic-within-bu2-using-ssh-client-bonus">8.2 Verify ICMP traffic within bu2 Using SSH Client<span style="color:#33ECFF">(BONUS)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#logs-verification">8.3 Logs Verification</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inter-rule-from-bu2-to-bu1">9. Inter-rule from bu2 to bu1</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verify-icmp-traffic-from-bu2-to-bu1-using-the-gatus-app">9.1 Verify ICMP traffic from bu2 to bu1 Using the Gatus App</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verify-icmp-traffic-from-bu2-to-bu1-using-ssh-client-bonus">9.2 Verify ICMP traffic from bu2 to bu1 Using SSH Client<span style="color:#33ECFF">(BONUS)</span></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#logs-monitor">10. Logs Monitor</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#east-1-and-the-multi-tier-transit">11. East-1 and the Multi-Tier Transit</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#activation-of-the-mtt">11.1 Activation of the MTT</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verification-of-icmp-traffic-between-azure-and-aws-using-gatus-app">11.2 Verification of ICMP traffic between Azure and AWS Using Gatus App</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verification-icmp-between-azure-and-aws-using-ssh-client-bonus">11.3 Verification ICMP between Azure and AWS Using SSH Client<span style="color:#33ECFF">(BONUS)</span></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#verification-of-the-mtt">12. Verification of the MTT</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-last-dcf-rule">13. The last DCF rule</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#icmp-verification-traffic-between-azure-and-aws-using-gatus-app-after-enabling-mtt">13.1 ICMP Verification  traffic between Azure and AWS Using Gatus App after enabling MTT</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#icmp-verification-between-azure-and-aws-using-ssh-client-after-enabling-mtt-bonus">13.2 ICMP Verification between Azure and AWS Using SSH Client after enabling MTT<span style="color:#33ECFF">(BONUS)</span></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#final-considerations">14. Final Considerations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#smart-group-east1">14.1 Smart Group “east1”</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-an-inter-rule-that-allows-icmp-from-bu2-towards-east1">14.2 Create an inter-rule that allows ICMP from bu2 towards east1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verify-connectivity-between-bu2-and-east1">14.3 Verify connectivity between bu2 and east1</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#icmp-verification-traffic-between-azure-and-aws-using-gatus-app-after-enabled-mtt">14.3.1 ICMP Verification  traffic between Azure and AWS Using Gatus App after enabled MTT</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#icmp-verification-between-azure-and-aws-using-ssh-client-after-enabled-mtt-bonus">14.3.2 ICMP Verification between Azure and AWS Using SSH Client after enabled MTT<span style="color:#33ECFF">(BONUS)</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">14.3.3 Logs</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spoke-to-spoke-attachment">15. Spoke to Spoke Attachment</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-a-spoke-to-spoke-attachment">15.1 Creating a Spoke to Spoke Attachment</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="lab-11-distributed-cloud-firewall">
<h1>Lab 11 - DISTRIBUTED CLOUD FIREWALL<a class="headerlink" href="#lab-11-distributed-cloud-firewall" title="Link to this heading">#</a></h1>
<section id="objective">
<h2>1. Objective<a class="headerlink" href="#objective" title="Link to this heading">#</a></h2>
<p>This lab will demonstrate how the <code class="docutils literal notranslate"><span class="pre">Distributed</span> <span class="pre">Cloud</span> <span class="pre">Firewall</span></code> works.</p>
</section>
<section id="distributed-cloud-firewall-overview">
<h2>2. Distributed Cloud Firewall Overview<a class="headerlink" href="#distributed-cloud-firewall-overview" title="Link to this heading">#</a></h2>
<p>The Distributed Cloud Firewall is a powerful feature of the <code class="docutils literal notranslate"><span class="pre">Aviatrix</span> <span class="pre">Cloud</span> <span class="pre">Firewall</span></code>, designed to enhance security across your cloud infrastructure. It offers a comprehensive suite of capabilities, including Distributed Firewalling, Threat Prevention, TLS Decryption, URL Filtering, Suricata Intrusion Detection and Prevention Systems (IDS/IPS), Advanced Network Address Translation (NAT) capabilities, and Micro-Segmentation.</p>
<p>In this lab, you will have the opportunity to create additional logical containers known as <code class="docutils literal notranslate"><span class="pre">Smart</span> <span class="pre">Groups</span></code>. These Smart Groups are designed to categorize instances within a VPC/VNet/VCN that share similar characteristics. Once you have organized your instances into these groups, you will then enforce security policies among them through <strong>Distributed Cloud Firewalling Rules</strong>. This approach not only streamlines management but also enhances security by allowing for targeted rule enforcement based on the specific behaviors and attributes of the grouped instances.</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">intra-rule</span></code> = Rule applied within a Smart Group</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inter-rule</span></code> = Rule applied among Smart Groups</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>At this point in the lab, there is a unique routing domain (i.e. a <strong><em>Flat Routing Domain</em></strong>), due to the connection policy applied in Lab 3, between the <span style='color:lightgreen'>Green</span> domain and the <span style='color:lightblue'>Blue</span> domain.</p>
</div>
<p>All test instances have been deployed with the standard cloud service provider <strong>(CSP) tags</strong>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The <strong>CSP tagging</strong> is the recommended method for defining the SmartGroups.</p>
</div>
<p>In this lab you are asked to achieve the following requirements among the instances deployed across the three CSPs:</p>
<ul class="simple">
<li><p>Create a Smart Group with the name <code class="docutils literal notranslate"><span class="pre">&quot;bu1&quot;</span></code> leveraging the tag <code class="docutils literal notranslate"><span class="pre">&quot;environment&quot;</span></code>.</p></li>
<li><p>Create a Smart Group with the name <code class="docutils literal notranslate"><span class="pre">&quot;bu2&quot;</span></code> leveraging the tag <code class="docutils literal notranslate"><span class="pre">&quot;environment&quot;</span></code>.</p></li>
<li><p>Create an <code class="docutils literal notranslate"><span class="pre">intra-rule</span></code> that allows ICMP traffic within bu1.</p></li>
<li><p>Create an <code class="docutils literal notranslate"><span class="pre">intra-rule</span></code> that allows ICMP traffic within bu2.</p></li>
<li><p>Create an <code class="docutils literal notranslate"><span class="pre">intra-rule</span></code> that allows SSH traffic within bu1.</p></li>
<li><p>Create an <code class="docutils literal notranslate"><span class="pre">inter-rule</span></code> that allows ICMP traffic only <ins>from</ins> bu2 <ins>to</ins> bu1.</p></li>
</ul>
<figure class="align-center" id="id4">
<a class="reference internal image-reference" href="../_images/lab10-initial.png"><img alt="../_images/lab10-initial.png" src="../_images/lab10-initial.png" style="height: 400px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 527 </span><span class="caption-text">Initial Topology Lab 11</span><a class="headerlink" href="#id4" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="smart-groups-creation">
<h2>3. Smart Groups Creation<a class="headerlink" href="#smart-groups-creation" title="Link to this heading">#</a></h2>
<p>Create two Smart Groups and classify each one using the CSP tag <code class="docutils literal notranslate"><span class="pre">&quot;environment&quot;</span></code>:</p>
<ul class="simple">
<li><p>Assign the name <code class="docutils literal notranslate"><span class="pre">&quot;bu1&quot;</span></code> to the Smart Group <strong>#1</strong>.</p></li>
<li><p>Assign the name <code class="docutils literal notranslate"><span class="pre">&quot;bu2&quot;</span></code> to the Smart Group <strong>#2</strong>.</p></li>
</ul>
<section id="smart-group-bu1">
<h3>3.1 Smart Group “bu1”<a class="headerlink" href="#smart-group-bu1" title="Link to this heading">#</a></h3>
<p>Go to <strong>CoPilot &gt; Groups &gt; SmartGroups</strong> and click on <code class="docutils literal notranslate"><span class="pre">&quot;+</span> <span class="pre">SmartGroup&quot;</span></code>.</p>
<figure class="align-center" id="id5">
<img alt="../_images/lab10-smart2.png" src="../_images/lab10-smart2.png" />
<figcaption>
<p><span class="caption-number">Fig. 528 </span><span class="caption-text">SmartGroup</span><a class="headerlink" href="#id5" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Ensure these parameters are entered in the pop-up window <code class="docutils literal notranslate"><span class="pre">&quot;Create</span> <span class="pre">SmartGroup&quot;</span></code>:</p>
<ul class="simple">
<li><p><strong>Name</strong>: <span style='color:#479608'>bu1</span></p></li>
<li><p><strong>Matches all conditions (AND)/environment</strong>: <span style='color:#479608'>bu1</span></p></li>
</ul>
<p>Before clicking on <strong>SAVE</strong>, discover what instances match the condition, turning on the knob <code class="docutils literal notranslate"><span class="pre">&quot;Preview&quot;</span></code>.</p>
<figure class="align-center" id="id6">
<img alt="../_images/lab10-smart3.png" src="../_images/lab10-smart3.png" />
<figcaption>
<p><span class="caption-number">Fig. 529 </span><span class="caption-text">Resource Selection</span><a class="headerlink" href="#id6" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The CoPilot shows that there are two instances that perfectly match the condition:</p>
<ul class="simple">
<li><p><strong>aws-us-east2-spoke1-test1</strong> in AWS</p></li>
<li><p><strong>azure-us-west-spoke1-test1</strong> in Azure</p></li>
</ul>
<figure class="align-center" id="id7">
<img alt="../_images/lab10-smart4.png" src="../_images/lab10-smart4.png" />
<figcaption>
<p><span class="caption-number">Fig. 530 </span><span class="caption-text">Resources that match the condition</span><a class="headerlink" href="#id7" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="smart-group-bu2">
<h3>3.2 Smart Group “bu2”<a class="headerlink" href="#smart-group-bu2" title="Link to this heading">#</a></h3>
<p>Create another Smart Group clicking on the <code class="docutils literal notranslate"><span class="pre">&quot;+</span> <span class="pre">SmartGroup&quot;</span></code> button.</p>
<figure class="align-center" id="id8">
<img alt="../_images/lab10-smart5.png" src="../_images/lab10-smart5.png" />
<figcaption>
<p><span class="caption-number">Fig. 531 </span><span class="caption-text">New Smart Group</span><a class="headerlink" href="#id8" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Ensure these parameters are entered in the pop-up window <code class="docutils literal notranslate"><span class="pre">&quot;Create</span> <span class="pre">SmartGroup&quot;</span></code>:</p>
<ul class="simple">
<li><p><strong>Name</strong>: <span style='color:#479608'>bu2</span></p></li>
<li><p><strong>Matches all conditions (AND)/environment</strong>: <span style='color:#479608'>bu2</span></p></li>
</ul>
<p>Before clicking on <strong>SAVE</strong>, discover what instances match the condition, turning on the knob <code class="docutils literal notranslate"><span class="pre">&quot;Preview&quot;</span></code>.</p>
<figure class="align-center" id="id9">
<img alt="../_images/lab10-smart6.png" src="../_images/lab10-smart6.png" />
<figcaption>
<p><span class="caption-number">Fig. 532 </span><span class="caption-text">Resource Selection</span><a class="headerlink" href="#id9" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The CoPilot shows that there are three instances that match the condition:</p>
<ul class="simple">
<li><p><strong>aws-us-east2-spoke1-test2</strong> in AWS</p></li>
<li><p><strong>azure-us-west-spoke2-test1</strong> in Azure</p></li>
<li><p><strong>gcp-us-central1-spoke1-test1</strong> in GCP</p></li>
</ul>
<figure class="align-center" id="id10">
<img alt="../_images/lab10-smart7.png" src="../_images/lab10-smart7.png" />
<figcaption>
<p><span class="caption-number">Fig. 533 </span><span class="caption-text">Resources that match the condition</span><a class="headerlink" href="#id10" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>At this stage, you have created logical containers that do not impact the existing routing domain, thanks to the <code class="docutils literal notranslate"><span class="pre">Connetion</span> <span class="pre">Policy</span></code> applied in <strong>Lab 3</strong>. Now, it’s time to thoroughly define Distributed Cloud Firewall (DCF) rules to govern <strong>East-West</strong> traffic.</p>
<p>Below is the current list of your DCF Rules within the <strong>Distributed Cloud Firewall</strong> section of your CoPilot:</p>
<figure class="align-center" id="id11">
<a class="reference internal image-reference" href="../_images/lab10-newone2.png"><img alt="../_images/lab10-newone2.png" src="../_images/lab10-newone2.png" style="height: 300px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 534 </span><span class="caption-text">Complete DCF Rules List</span><a class="headerlink" href="#id11" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="connectivity-verification-icmp-using-gatus-app">
<h3>3.3 Connectivity Verification (ICMP) Using Gatus App<a class="headerlink" href="#connectivity-verification-icmp-using-gatus-app" title="Link to this heading">#</a></h3>
<p>Navigate to your POD Portal, locate the <code class="docutils literal notranslate"><span class="pre">Gatus</span> <span class="pre">widget</span></code>, and select <strong><em>aws-us-east-2-spoke1-test1</em></strong>.</p>
<p>Insert the credentials available on your POD Portal and then click on <strong>“Sign in”</strong>.</p>
<figure class="align-center" id="id12">
<a class="reference internal image-reference" href="../_images/lab10-gatus00.png"><img alt="../_images/lab10-gatus00.png" src="../_images/lab10-gatus00.png" style="height: 400px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 535 </span><span class="caption-text">Gatus</span><a class="headerlink" href="#id12" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id13">
<a class="reference internal image-reference" href="../_images/lab10-gatus01.png"><img alt="../_images/lab10-gatus01.png" src="../_images/lab10-gatus01.png" style="height: 400px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 536 </span><span class="caption-text">aws-us-east-2-spoke1-test1</span><a class="headerlink" href="#id13" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The <strong>East-West</strong> traffic is disrupted. The instance <strong><em>aws-us-east-2-spoke1-test1</em></strong> can only reach <strong>test2</strong> due to intra-VPC traffic, which bypasses the Aviatrix Spoke Gateway (i.e. the <strong>Enforcement Security Point</strong>).</p>
</section>
<section id="connectivity-verification-icmp-using-ssh-client-bonus">
<h3>3.4 Connectivity Verification (ICMP) Using SSH Client <span style='color:#33ECFF'>(BONUS)</span></summary><a class="headerlink" href="#connectivity-verification-icmp-using-ssh-client-bonus" title="Link to this heading">#</a></h3>
<p>Open a terminal window and SSH into the public IP of the instance <strong>aws-us-east-2-spoke1-<span style='color:red'>test1</span></strong> (<em>NOT test2</em>). From there, ping the private IPs of each other instances to verify that the connectivity is indeed <strong>broken</strong>!</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Refer to your POD for the private IPs.</p>
</div>
<figure class="align-center" id="id14">
<a class="reference internal image-reference" href="../_images/lab10-newone.png"><img alt="../_images/lab10-newone.png" src="../_images/lab10-newone.png" style="height: 400px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 537 </span><span class="caption-text">SSH</span><a class="headerlink" href="#id14" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id15">
<img alt="../_images/lab10-newone3.png" src="../_images/lab10-newone3.png" />
<figcaption>
<p><span class="caption-number">Fig. 538 </span><span class="caption-text">Ping</span><a class="headerlink" href="#id15" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id16">
<img alt="../_images/lab10-newone43.png" src="../_images/lab10-newone43.png" />
<figcaption>
<p><span class="caption-number">Fig. 539 </span><span class="caption-text">Ping</span><a class="headerlink" href="#id16" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>From the outcomes above, you can see that only the <strong>aws-us-east-2-spoke1-<span style='color:red'>test2</span></strong> instance is pingable. This is because the ICMP traffic from aws-us-east-2-spoke1-test1 to aws-us-east-2-spoke1-test2 is NOT passing through the Spoke Gateway.</p>
<p>The ICMP traffic is utilizing the standard behavior of intra-VPC communication.</p>
</div>
</section>
<section id="connectivity-verification-ssh-using-gatus-app">
<h3>3.5 Connectivity Verification (SSH) Using Gatus App<a class="headerlink" href="#connectivity-verification-ssh-using-gatus-app" title="Link to this heading">#</a></h3>
<p>From the Gatus App open on <strong><em>aws-us-east-2-spoke1-test1</em></strong>, verify the SSH section.</p>
<figure class="align-center" id="id17">
<a class="reference internal image-reference" href="../_images/lab10-gatus02.png"><img alt="../_images/lab10-gatus02.png" src="../_images/lab10-gatus02.png" style="height: 400px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 540 </span><span class="caption-text">aws-us-east-2-spoke1-test1</span><a class="headerlink" href="#id17" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The SSH test is only successful against <strong><em>aws-us-east-2-spoke1-test2</em></strong> due to intra-VPC traffic.</p>
</section>
<section id="connectivity-verification-ssh-using-ssh-client-bonus">
<h3>3.6  Connectivity Verification (SSH) Using SSH Client <span style='color:#33ECFF'>(BONUS)</span></summary><a class="headerlink" href="#connectivity-verification-ssh-using-ssh-client-bonus" title="Link to this heading">#</a></h3>
<p>Verify also from the instance <strong>aws-us-east-2-spoke1-test1</strong> that you <strong><em>can’t</em></strong> SSH to any other instances, except to the <strong>aws-us-east-2-spoke1-test2</strong>, due to the fact that the SSH connection in this case, is established once again within the VPC, <ins>bypassing the Spoke Gateway (i.e. the DCF Enforcement Point)</ins>!</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Refer to your POD for the private IPs.</p>
</div>
<figure class="align-center" id="id18">
<img alt="../_images/lab10-sshtoaws.png" src="../_images/lab10-sshtoaws.png" />
<figcaption>
<p><span class="caption-number">Fig. 541 </span><span class="caption-text">SSH to test2 in AWS US-East-2–&gt; OK</span><a class="headerlink" href="#id18" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id19">
<img alt="../_images/lab10-sshnew2.png" src="../_images/lab10-sshnew2.png" />
<figcaption>
<p><span class="caption-number">Fig. 542 </span><span class="caption-text">SSH fails towards the other instances</span><a class="headerlink" href="#id19" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The previous results clearly confirm that connectivity is disrupted, allowing only <code class="docutils literal notranslate"><span class="pre">intra-vpc</span> <span class="pre">traffic</span></code>.</p>
</section>
</section>
<section id="dcf-rules-creation">
<h2>4. DCF Rules Creation<a class="headerlink" href="#dcf-rules-creation" title="Link to this heading">#</a></h2>
<section id="create-an-intra-rule-that-allows-icmp-inside-bu1">
<h3>4.1. Create an intra-rule that allows ICMP inside bu1<a class="headerlink" href="#create-an-intra-rule-that-allows-icmp-inside-bu1" title="Link to this heading">#</a></h3>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Zero Trust architecture is “Never trust, always verify”, a critical component to enterprise cloud adoption success!</p>
</div>
<p>Go to <strong>CoPilot &gt; Security &gt; Distributed Cloud Firewall &gt; Rules (default tab)</strong> and create a new rule clicking on the <code class="docutils literal notranslate"><span class="pre">&quot;+</span> <span class="pre">Rule&quot;</span></code> button.</p>
<figure class="align-center" id="id20">
<img alt="../_images/lab10-newrule.png" src="../_images/lab10-newrule.png" />
<figcaption>
<p><span class="caption-number">Fig. 543 </span><span class="caption-text">New Rule</span><a class="headerlink" href="#id20" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Insert the following parameters:</p>
<ul class="simple">
<li><p><strong>Name</strong>: <span style='color:#479608'>intra-icmp-bu1</span></p></li>
<li><p><strong>Source Smartgroups</strong>: <span style='color:#479608'>bu1</span></p></li>
<li><p><strong>Destination Smartgroups</strong>: <span style='color:#479608'>bu1</span></p></li>
<li><p><strong>Protocol</strong>: <span style='color:#479608'>ICMP</span></p></li>
<li><p><strong>Logging</strong>: <span style='color:#479608'>On</span></p></li>
<li><p><strong>Action</strong>: <span style='color:#479608'><strong>Permit</strong></span></p></li>
</ul>
<p>Do not forget to click on <strong>Save In Drafts</strong>.</p>
<figure class="align-center" id="id21">
<img alt="../_images/lab10-rule1.png" src="../_images/lab10-rule1.png" />
<figcaption>
<p><span class="caption-number">Fig. 544 </span><span class="caption-text">Create Rule</span><a class="headerlink" href="#id21" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Click on <strong>Commit</strong>.</p>
<figure class="align-center" id="id22">
<img alt="../_images/lab10-rulecommitted00.png" src="../_images/lab10-rulecommitted00.png" />
<figcaption>
<p><span class="caption-number">Fig. 545 </span><span class="caption-text">Rule committed</span><a class="headerlink" href="#id22" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="create-an-intra-rule-that-allows-icmp-inside-bu2">
<h3>4.2. Create an intra-rule that allows ICMP inside bu2<a class="headerlink" href="#create-an-intra-rule-that-allows-icmp-inside-bu2" title="Link to this heading">#</a></h3>
<p>Create another rule clicking on the <code class="docutils literal notranslate"><span class="pre">&quot;+</span> <span class="pre">Rule&quot;</span></code> button.</p>
<figure class="align-center" id="id23">
<img alt="../_images/lab10-rule3.png" src="../_images/lab10-rule3.png" />
<figcaption>
<p><span class="caption-number">Fig. 546 </span><span class="caption-text">New rule</span><a class="headerlink" href="#id23" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Ensure these parameters are entered in the pop-up window <code class="docutils literal notranslate"><span class="pre">&quot;Create</span> <span class="pre">Rule&quot;</span></code>:</p>
<ul class="simple">
<li><p><strong>Name</strong>: <span style='color:#479608'>intra-icmp-bu2</span></p></li>
<li><p><strong>Source Smartgroups</strong>: <span style='color:#479608'>bu2</span></p></li>
<li><p><strong>Destination Smartgroups</strong>: <span style='color:#479608'>bu2</span></p></li>
<li><p><strong>Protocol</strong>: <span style='color:#479608'>ICMP</span></p></li>
<li><p><strong>Logging</strong>: <span style='color:#479608'>On</span></p></li>
<li><p><strong>Action</strong>: <span style='color:#479608'><strong>Permit</strong></span></p></li>
<li><p><strong>Place Rule</strong>: <span style='color:#479608'>Below</span></p>
<ul>
<li><p><strong>Existing Rule</strong>: <span style='color:#479608'>intra-icmp-bu1</span></p></li>
</ul>
</li>
</ul>
<p>Do not forget to click on <strong>Save In Drafts</strong>.</p>
<figure class="align-center" id="id24">
<img alt="../_images/lab10-intrabu2.png" src="../_images/lab10-intrabu2.png" />
<figcaption>
<p><span class="caption-number">Fig. 547 </span><span class="caption-text">intra-icmp-bu2</span><a class="headerlink" href="#id24" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Now proceed and click on the <strong>Commit</strong> button.</p>
<figure class="align-center" id="id25">
<img alt="../_images/lab10-rulecommitted01.png" src="../_images/lab10-rulecommitted01.png" />
<figcaption>
<p><span class="caption-number">Fig. 548 </span><span class="caption-text">Rule committed</span><a class="headerlink" href="#id25" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="verification">
<h2>5. Verification<a class="headerlink" href="#verification" title="Link to this heading">#</a></h2>
<p>Following the creation of the previous Smart Groups and Rules, the topology with the permitted protocols will appear as follows:</p>
<figure class="align-center" id="id26">
<a class="reference internal image-reference" href="../_images/lab10-topology2.png"><img alt="../_images/lab10-topology2.png" src="../_images/lab10-topology2.png" style="height: 400px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 549 </span><span class="caption-text">New Topology</span><a class="headerlink" href="#id26" title="Link to this image">#</a></p>
</figcaption>
</figure>
<section id="verify-icmp-within-bu1-and-from-bu1-towards-bu2-using-the-gatus-app">
<h3>5.1 Verify ICMP within bu1 and from bu1 towards bu2 Using the Gatus App<a class="headerlink" href="#verify-icmp-within-bu1-and-from-bu1-towards-bu2-using-the-gatus-app" title="Link to this heading">#</a></h3>
<p>Open the Gatus App on <strong><em>aws-us-east-2-spoke1-test1</em></strong> and verify the ICMP Traffic.</p>
<figure class="align-center" id="id27">
<img alt="../_images/lab10-gatus80.png" src="../_images/lab10-gatus80.png" />
<figcaption>
<p><span class="caption-number">Fig. 550 </span><span class="caption-text">Gatus</span><a class="headerlink" href="#id27" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p><strong><em>aws-us-east-2-spoke1-test1</em></strong> and <strong><em>azure-west-us-spoke1-test1</em></strong> can ping each other due to the intra-rule applied to the SmartGroup “bu1”.</p>
<p>However, <strong><em>aws-us-east-2-spoke1-test1</em></strong> is also capable of pinging <strong><em>aws-us-east-2-spoke1-test<span style='color:red'>2</span></summary></em></strong>, although the latter belongs to “bu2”. Once again, this behaviour stems from the fact that the two instances reside in the same VPC.</p>
</section>
<section id="verify-ssh-traffic-from-your-laptop-to-bu1-using-ssh-client-bonus">
<h3>5.2 Verify SSH traffic from your laptop to bu1 Using SSH Client <span style='color:#33ECFF'>(BONUS)</span></summary><a class="headerlink" href="#verify-ssh-traffic-from-your-laptop-to-bu1-using-ssh-client-bonus" title="Link to this heading">#</a></h3>
<p>SSH to the Public IP of the instance <strong>aws-us-east-2-spoke1-test1</strong>.</p>
<figure class="align-center" id="id28">
<img alt="../_images/lab10-sshpod.png" src="../_images/lab10-sshpod.png" />
<figcaption>
<p><span class="caption-number">Fig. 551 </span><span class="caption-text">SSH from your laptop</span><a class="headerlink" href="#id28" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>The SSH session from your laptop to the <strong><em>aws-us-east-2-spoke1-test1</em></strong> instance is not affected by any DCF rules, because the connection is established directly through the <strong>AWS IGW</strong>.</p>
</div>
<figure class="align-center" id="id29">
<img alt="../_images/lab10-laptop.png" src="../_images/lab10-laptop.png" />
<figcaption>
<p><span class="caption-number">Fig. 552 </span><span class="caption-text">SSH from your laptop - logical diagram</span><a class="headerlink" href="#id29" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="verify-icmp-within-bu1-and-from-bu1-towards-bu2-using-the-ssh-client-bonus">
<h3>5.3 Verify ICMP within bu1 and from bu1 towards bu2 Using the SSH Client <span style='color:#33ECFF'>(BONUS)</span></summary><a class="headerlink" href="#verify-icmp-within-bu1-and-from-bu1-towards-bu2-using-the-ssh-client-bonus" title="Link to this heading">#</a></h3>
<p>Ping the following instances from <strong>aws-us-east-2-spoke1-test1</strong>:</p>
<ul class="simple">
<li><p><strong>gcp-us-central1-spoke1-test1</strong> in GCP</p></li>
<li><p><strong>azure-west-us-spoke1-test1</strong> in Azure</p></li>
<li><p><strong>azure-west-us-spoke2-test1</strong> in Azure</p></li>
</ul>
<p>According to the rules created before, only the ping towards the <strong>azure-us-west-spoke1-test1</strong> will work, because this instance belongs to the same Smart Group bu1 as the instance from where you generated ICMP traffic.</p>
<figure class="align-center" id="id30">
<img alt="../_images/lab10-pingcheck.png" src="../_images/lab10-pingcheck.png" />
<figcaption>
<p><span class="caption-number">Fig. 553 </span><span class="caption-text">Ping</span><a class="headerlink" href="#id30" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Now, let’s try to ping the instance <strong>aws-us-east-2-spoke1-test2</strong> from <strong>aws-us-east-2-spoke1-test1</strong>.</p>
<figure class="align-center" id="id31">
<img alt="../_images/lab10-pingtotest2.png" src="../_images/lab10-pingtotest2.png" />
<figcaption>
<p><span class="caption-number">Fig. 554 </span><span class="caption-text">Ping</span><a class="headerlink" href="#id31" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p><strong>aws-us-east-2-spoke1-test1</strong> can successfully ping <strong>aws-us-east-2-spoke1-test<span style='color:red'>2</span></summary></strong> because the communication occurs within the VPC, bypassing the Spoke Gateway.</p>
</section>
<section id="sg-orchestration">
<h3>5.4 SG Orchestration<a class="headerlink" href="#sg-orchestration" title="Link to this heading">#</a></h3>
<p>Let’s investigate the logs:</p>
<p>Go to <strong>CoPilot &gt; Security &gt; Distributed Cloud Firewall &gt; Monitor</strong> and then click on the filter icon and filter out based on the rule <code class="docutils literal notranslate"><span class="pre">&quot;intra-icmp-bu1&quot;</span></code>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Filter out based on the protocol <strong>ICMP</strong>.</p>
<figure class="align-center" id="id32">
<img alt="../_images/lab10-monitor100.png" src="../_images/lab10-monitor100.png" />
<figcaption>
<p><span class="caption-number">Fig. 555 </span><span class="caption-text">Filter</span><a class="headerlink" href="#id32" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
<figure class="align-center" id="id33">
<img alt="../_images/lab10-monitor.png" src="../_images/lab10-monitor.png" />
<figcaption>
<p><span class="caption-number">Fig. 556 </span><span class="caption-text">Outcomes</span><a class="headerlink" href="#id33" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Based on the outcome above, you will not see 10.0.1.10 (aws-us-east-2-spoke1-test2) because it belongs to bu2, which does not match the intra-icmp-bu1 rule.</p>
<p>However, <strong>aws-us-east-2-spoke1-test1</strong> can ping <strong>aws-us-east-2-spoke1-test2</strong> due to intra-VPC communication, without needing to match any of the deployed DCF rules.</p>
<figure class="align-center" id="id34">
<img alt="../_images/lab10-sgorch01.png" src="../_images/lab10-sgorch01.png" />
<figcaption>
<p><span class="caption-number">Fig. 557 </span><span class="caption-text">tes1 and test2 in AWS US-EAST-2</span><a class="headerlink" href="#id34" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id35">
<img alt="../_images/lab10-sgorch02.png" src="../_images/lab10-sgorch02.png" />
<figcaption>
<p><span class="caption-number">Fig. 558 </span><span class="caption-text">tes1 and test2 in AWS US-EAST-2</span><a class="headerlink" href="#id35" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The instances <strong>aws-us-east-2-spoke1-test1</strong> and <strong>aws-us-east-2-spoke1-test2</strong> are in the same VPC. Although these two instances have been deployed in <ins>two distinct and separate Smart Groups</ins>, the communication will occur until you don’t enable the <code class="docutils literal notranslate"><span class="pre">&quot;Security</span> <span class="pre">Group(SG)</span> <span class="pre">Orchestration&quot;</span></code> (aka <strong><em>intra-vpc separation</em></strong>).</p>
</div>
<p>Go to <strong>CoPilot &gt; Security &gt; Distributed Cloud Firewall &gt; Settings</strong> and click on the <code class="docutils literal notranslate"><span class="pre">&quot;Manage&quot;</span></code> button, inside the <code class="docutils literal notranslate"><span class="pre">&quot;Security</span> <span class="pre">Group</span> <span class="pre">(SG)</span> <span class="pre">Orchestration&quot;</span></code> field.</p>
<figure class="align-center" id="id36">
<a class="reference internal image-reference" href="../_images/lab10-orchestration.png"><img alt="../_images/lab10-orchestration.png" src="../_images/lab10-orchestration.png" style="height: 300px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 559 </span><span class="caption-text">SG Orchestration</span><a class="headerlink" href="#id36" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Enable the <strong><em>SG orchestration</em></strong> feature on the <strong><em>aws-us-east-2-spoke1</em></strong> VPC, flag the checkbox  <code class="docutils literal notranslate"><span class="pre">&quot;I</span> <span class="pre">understand</span> <span class="pre">the</span> <span class="pre">network</span> <span class="pre">impact</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">changes&quot;</span></code> and then click on <strong>Save</strong>.</p>
<figure class="align-center" id="id37">
<img alt="../_images/lab10-orchestration2.png" src="../_images/lab10-orchestration2.png" />
<figcaption>
<p><span class="caption-number">Fig. 560 </span><span class="caption-text">Manage SG Orchestration</span><a class="headerlink" href="#id37" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="sg-orchestration-verification-using-the-gatus-app">
<h3>5.5 SG Orchestration Verification Using the Gatus App<a class="headerlink" href="#sg-orchestration-verification-using-the-gatus-app" title="Link to this heading">#</a></h3>
<p>Open the Gatus App on <strong><em>aws-us-east-2-spoke1-test1</em></strong> and verify the connectivity with <strong><em>aws-us-east-2-spoke1-test2</em></strong>.</p>
<figure class="align-center" id="id38">
<img alt="../_images/lab10-gatus81.png" src="../_images/lab10-gatus81.png" />
<figcaption>
<p><span class="caption-number">Fig. 561 </span><span class="caption-text">Gatus</span><a class="headerlink" href="#id38" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The ping to test2 will gradually fail!</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>SSH traffic will also fail!</p>
</div>
<figure class="align-center" id="id39">
<img alt="../_images/lab10-gatus8786.png" src="../_images/lab10-gatus8786.png" />
<figcaption>
<p><span class="caption-number">Fig. 562 </span><span class="caption-text">Gatus</span><a class="headerlink" href="#id39" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="sg-orchestration-verification-using-the-ssh-client-bonus">
<h3>5.6 SG Orchestration Verification Using the SSH Client <span style='color:#33ECFF'>(BONUS)</span></summary><a class="headerlink" href="#sg-orchestration-verification-using-the-ssh-client-bonus" title="Link to this heading">#</a></h3>
<p>Relaunch the ping from <strong>aws-us-east-2-spoke1-<span style='color:#479608'>test1</span></strong> towards <strong>aws-us-east-2-spoke1-<span style='color:red'>test2</span></strong>.</p>
<figure class="align-center" id="id40">
<img alt="../_images/lab10-pingtotest2fail.png" src="../_images/lab10-pingtotest2fail.png" />
<figcaption>
<p><span class="caption-number">Fig. 563 </span><span class="caption-text">Ping fails</span><a class="headerlink" href="#id40" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>This time the ping fails. You have achieved a complete separation between Smart Groups deployed in the same VPC in AWS US-EAST-2 region, thanks to the Security Group Orchestration carried out by the <strong>Aviatrix Controller</strong>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>SSH traffic will also fail!</p>
</div>
</section>
<section id="verify-ssh-within-bu1-using-the-gatus-app">
<h3>5.7 Verify SSH within bu1 Using the Gatus App<a class="headerlink" href="#verify-ssh-within-bu1-using-the-gatus-app" title="Link to this heading">#</a></h3>
<p>Open the Gatus App on <strong><em>aws-us-east-2-spoke1-test1</em></strong> and verify the SSH Traffic.</p>
<figure class="align-center" id="id41">
<img alt="../_images/lab10-gatus88.png" src="../_images/lab10-gatus88.png" />
<figcaption>
<p><span class="caption-number">Fig. 564 </span><span class="caption-text">Gatus</span><a class="headerlink" href="#id41" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p><strong><em>aws-us-east-2-spoke1-test1</em></strong>  is unable to SSH into any other instances within bu1, as well as those in bu2.</p>
</section>
<section id="verify-ssh-within-bu1-using-the-ssh-client-bonus">
<h3>5.8 Verify SSH within bu1 Using the SSH Client <span style='color:#33ECFF'>(BONUS)</span></summary><a class="headerlink" href="#verify-ssh-within-bu1-using-the-ssh-client-bonus" title="Link to this heading">#</a></h3>
<p>SSH to the Private IP of the instance <strong><em>azure-west-us-spoke1-test1</em></strong> in Azure. Despite the fact that the instance is within the same Smart Group “bu1”, the SSH will fail due to the absence of a dedicated rule that would permit SSH traffic within the Smart Group.</p>
<figure class="align-center" id="id42">
<img alt="../_images/lab10-sshfail.png" src="../_images/lab10-sshfail.png" />
<figcaption>
<p><span class="caption-number">Fig. 565 </span><span class="caption-text">SSH fails</span><a class="headerlink" href="#id42" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="add-a-rule-that-allows-ssh-in-bu1">
<h3>5.9 Add a rule that allows SSH in bu1<a class="headerlink" href="#add-a-rule-that-allows-ssh-in-bu1" title="Link to this heading">#</a></h3>
<p>Create another rule clicking on the <code class="docutils literal notranslate"><span class="pre">&quot;+</span> <span class="pre">Rule&quot;</span></code> button.</p>
<figure class="align-center" id="id43">
<img alt="../_images/lab10-newrule2.png" src="../_images/lab10-newrule2.png" />
<figcaption>
<p><span class="caption-number">Fig. 566 </span><span class="caption-text">New rule</span><a class="headerlink" href="#id43" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Ensure these parameters are entered in the pop-up window <code class="docutils literal notranslate"><span class="pre">&quot;Create</span> <span class="pre">Rule&quot;</span></code>:</p>
<ul class="simple">
<li><p><strong>Name</strong>: <span style='color:#479608'>intra-ssh-bu1</span></p></li>
<li><p><strong>Source Smartgroups</strong>: <span style='color:#479608'>bu1</span></p></li>
<li><p><strong>Destination Smartgroups</strong>: <span style='color:#479608'>bu1</span></p></li>
<li><p><strong>Protocol</strong>: <span style='color:#479608'>TCP</span></p></li>
<li><p><strong>Port</strong>: <span style='color:#479608'>22</span></p></li>
<li><p><strong>Logging</strong>: <span style='color:#479608'>On</span></p></li>
<li><p><strong>Action</strong>: <span style='color:#479608'><strong>Permit</strong></span></p></li>
<li><p><strong>Place Rule</strong>: <span style='color:#479608'>Below</span></p>
<ul>
<li><p><strong>Existing Rule</strong>: <span style='color:#479608'>intra-icmp-bu2</span></p></li>
</ul>
</li>
</ul>
<p>Do not forget to click on <strong>Save In Drafts</strong>.</p>
<figure class="align-center" id="id44">
<img alt="../_images/lab10-sshbu1.png" src="../_images/lab10-sshbu1.png" />
<figcaption>
<p><span class="caption-number">Fig. 567 </span><span class="caption-text">Create rule</span><a class="headerlink" href="#id44" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Click on <code class="docutils literal notranslate"><span class="pre">&quot;Commit&quot;</span></code> to enforce the new rule into the <strong>Data Plane</strong>.</p>
<figure class="align-center" id="id45">
<a class="reference internal image-reference" href="../_images/lab10-commitsshbu1.png"><img alt="../_images/lab10-commitsshbu1.png" src="../_images/lab10-commitsshbu1.png" style="height: 300px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 568 </span><span class="caption-text">Commit</span><a class="headerlink" href="#id45" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="verification-after-the-intra-rule">
<h2>6. Verification after the intra-rule<a class="headerlink" href="#verification-after-the-intra-rule" title="Link to this heading">#</a></h2>
<section id="id1">
<h3>6.1 Verify SSH within bu1 Using the Gatus App<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>Open the Gatus App on <strong><em>aws-us-east-2-spoke1-test1</em></strong> and verify the SSH Traffic.</p>
<figure class="align-center" id="id46">
<img alt="../_images/lab10-gatus97.png" src="../_images/lab10-gatus97.png" />
<figcaption>
<p><span class="caption-number">Fig. 569 </span><span class="caption-text">Gatus</span><a class="headerlink" href="#id46" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p><strong><em>aws-us-east-2-spoke1-test1</em></strong> can now SSH to <strong><em>azure-west-us-spoke1-test1</em></strong></p>
</section>
<section id="id2">
<h3>6.2 Verify SSH within bu1 Using the SSH Client <span style='color:#33ECFF'>(BONUS)</span></summary><a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Try once again to SSH to the Private IP of the instance <strong><em>azure-west-us-spoke1-<span style='color:red'>test1</span></em></strong> in Azure in BU1.</p></li>
</ul>
<p>This time the connection will be established, thanks to the new intra-rule.</p>
<figure class="align-center" id="id47">
<img alt="../_images/lab10-sshbu1ok.png" src="../_images/lab10-sshbu1ok.png" />
<figcaption>
<p><span class="caption-number">Fig. 570 </span><span class="caption-text">SSH ok</span><a class="headerlink" href="#id47" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="logs">
<h2>7. Logs<a class="headerlink" href="#logs" title="Link to this heading">#</a></h2>
<p>Let’s investigate the logs once again.</p>
<p>Go to <strong>CoPilot &gt; Security &gt; Distributed Cloud Firewall &gt; Monitor</strong> and filter out based on the <strong>intra-ssh-bu1</strong> Rule!</p>
<figure class="align-center" id="id48">
<a class="reference internal image-reference" href="../_images/lab10-logsshbu187.png"><img alt="../_images/lab10-logsshbu187.png" src="../_images/lab10-logsshbu187.png" style="height: 150px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 571 </span><span class="caption-text">Logs</span><a class="headerlink" href="#id48" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id49">
<a class="reference internal image-reference" href="../_images/lab10-logsshbu1.png"><img alt="../_images/lab10-logsshbu1.png" src="../_images/lab10-logsshbu1.png" style="height: 150px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 572 </span><span class="caption-text">Logs</span><a class="headerlink" href="#id49" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The log above clearly indicates that the <code class="docutils literal notranslate"><span class="pre">&quot;intra-ssh-bu1&quot;</span></code> rule is successfully permitting SSH traffic within the Smart Group bu1.</p>
<p>Following the creation of this intra-rule, the topology with the permitted protocols will appear as follows:</p>
<figure class="align-center" id="id50">
<a class="reference internal image-reference" href="../_images/lab10-topologynew.png"><img alt="../_images/lab10-topologynew.png" src="../_images/lab10-topologynew.png" style="height: 400px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 573 </span><span class="caption-text">New Topology</span><a class="headerlink" href="#id50" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="verification-inside-bu2">
<h2>8.  Verification inside bu2<a class="headerlink" href="#verification-inside-bu2" title="Link to this heading">#</a></h2>
<section id="verify-icmp-traffic-within-bu2-using-gatus-app">
<h3>8.1 Verify ICMP traffic within bu2 Using Gatus App<a class="headerlink" href="#verify-icmp-traffic-within-bu2-using-gatus-app" title="Link to this heading">#</a></h3>
<p>Open the Gatus App on <strong><em>gcp-us-central1-spoke1-test1</em></strong> and verify the ICMP Traffic.</p>
<figure class="align-center" id="id51">
<img alt="../_images/lab10-gatus34.png" src="../_images/lab10-gatus34.png" />
<figcaption>
<p><span class="caption-number">Fig. 574 </span><span class="caption-text">Gatus</span><a class="headerlink" href="#id51" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Ping towards the <strong><em>azure-west-us-spoke2-test1</em></strong> and <strong><em>aws-us-east-2-spoke1-test2</em></strong> will work, because these two instance belongs to the same Smart Group bu2!</p>
</section>
<section id="verify-icmp-traffic-within-bu2-using-ssh-client-bonus">
<h3>8.2 Verify ICMP traffic within bu2 Using SSH Client<span style='color:#33ECFF'>(BONUS)</span></summary><a class="headerlink" href="#verify-icmp-traffic-within-bu2-using-ssh-client-bonus" title="Link to this heading">#</a></h3>
<p>SSH to the Public IP of the instance <strong><em>gcp-us-central1-spoke1-test1</em></strong>:</p>
<figure class="align-center" id="id52">
<img alt="../_images/lab10-sshtocentral.png" src="../_images/lab10-sshtocentral.png" />
<figcaption>
<p><span class="caption-number">Fig. 575 </span><span class="caption-text">SSH to gcp-us-central1-spoke1-test1</span><a class="headerlink" href="#id52" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Ping the following instances:</p>
<ul class="simple">
<li><p><strong>aws-us-east-2-spoke1-test1</strong> in AWS</p></li>
<li><p><strong>aws-us-east-2-spoke1-test2</strong> in AWS</p></li>
<li><p><strong>azure-west-us-spoke1-test1</strong> in Azure</p></li>
<li><p><strong>azure-west-us-spoke2-test1</strong> in Azure</p></li>
</ul>
<p>According to the rules created before, only the ping towards the <strong>azure-west-us-spoke2-test1</strong> and <strong>aws-us-east-2-spoke1-test2</strong> will work, because these two instance belongs to the same Smart Group <strong>bu2</strong> as the instance from where you executed the ICMP traffic.</p>
<figure class="align-center" id="id53">
<img alt="../_images/lab10-pingtestgcp.png" src="../_images/lab10-pingtestgcp.png" />
<figcaption>
<p><span class="caption-number">Fig. 576 </span><span class="caption-text">Ping</span><a class="headerlink" href="#id53" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="logs-verification">
<h3>8.3 Logs Verification<a class="headerlink" href="#logs-verification" title="Link to this heading">#</a></h3>
<p>Let’s investigate the logs once again.</p>
<p>Go to <strong>CoPilot &gt; Security &gt; Distributed Cloud Firewall &gt; Monitor</strong> and filter based on the <em>intra-icmp-bu2</em> rule.</p>
<figure class="align-center" id="id54">
<a class="reference internal image-reference" href="../_images/lab10-bu23monitor.png"><img alt="../_images/lab10-bu23monitor.png" src="../_images/lab10-bu23monitor.png" style="height: 150px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 577 </span><span class="caption-text">intra-icmp-bu2</span><a class="headerlink" href="#id54" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id55">
<a class="reference internal image-reference" href="../_images/lab10-bu2monitor.png"><img alt="../_images/lab10-bu2monitor.png" src="../_images/lab10-bu2monitor.png" style="height: 150px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 578 </span><span class="caption-text">Monitor</span><a class="headerlink" href="#id55" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The logs above confirm that the <strong>ICMP</strong> protocol is permitted within the Smart Group bu2.</p>
</section>
</section>
<section id="inter-rule-from-bu2-to-bu1">
<h2>9. Inter-rule from bu2 to bu1<a class="headerlink" href="#inter-rule-from-bu2-to-bu1" title="Link to this heading">#</a></h2>
<p>Create a new rule that allows ICMP FROM bu2 TO bu1.</p>
<p>Go to <strong>CoPilot &gt; Security &gt; Distributed Cloud Firewall &gt; Rules</strong> and click on the <code class="docutils literal notranslate"><span class="pre">&quot;+</span> <span class="pre">Rule&quot;</span></code> button.</p>
<figure class="align-center" id="id56">
<img alt="../_images/lab10-newrule4.png" src="../_images/lab10-newrule4.png" />
<figcaption>
<p><span class="caption-number">Fig. 579 </span><span class="caption-text">New Rule</span><a class="headerlink" href="#id56" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Ensure these parameters are entered in the pop-up window <code class="docutils literal notranslate"><span class="pre">&quot;Create</span> <span class="pre">New</span> <span class="pre">Rule&quot;</span></code>:</p>
<ul class="simple">
<li><p><strong>Name</strong>: <span style='color:#479608'>inter-icmp-bu2-bu1</span></p></li>
<li><p><strong>Source Smartgroups</strong>: <span style='color:#479608'>bu2</span></p></li>
<li><p><strong>Destination Smartgroups</strong>: <span style='color:#479608'>bu1</span></p></li>
<li><p><strong>Protocol</strong>: <span style='color:#479608'>ICMP</span></p></li>
<li><p><strong>Logging</strong>: <span style='color:#479608'>On</span></p></li>
<li><p><strong>Action</strong>: <span style='color:#479608'><strong>Permit</strong></span></p></li>
<li><p><strong>Place Rule</strong>: <span style='color:#479608'>Below</span></p>
<ul>
<li><p><strong>Existing Rule</strong>: <span style='color:#479608'>intra-ssh-bu1</span></p></li>
</ul>
</li>
</ul>
<p>Do not forget to click on <strong>Save In Drafts</strong>.</p>
<figure class="align-center" id="id57">
<img alt="../_images/lab10-interssh.png" src="../_images/lab10-interssh.png" />
<figcaption>
<p><span class="caption-number">Fig. 580 </span><span class="caption-text">Create Rule</span><a class="headerlink" href="#id57" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Enforce this new rule into the Data Plane clicking on the <code class="docutils literal notranslate"><span class="pre">&quot;Commit&quot;</span></code> button.</p>
<section id="verify-icmp-traffic-from-bu2-to-bu1-using-the-gatus-app">
<h3>9.1 Verify ICMP traffic from bu2 to bu1 Using the Gatus App<a class="headerlink" href="#verify-icmp-traffic-from-bu2-to-bu1-using-the-gatus-app" title="Link to this heading">#</a></h3>
<p>Open the Gatus App on <strong><em>azure-west-us-spoke2-test1</em></strong> and verify the ICMP Traffic.</p>
<figure class="align-center" id="id58">
<img alt="../_images/lab10-newcommit2.png" src="../_images/lab10-newcommit2.png" />
<figcaption>
<p><span class="caption-number">Fig. 581 </span><span class="caption-text">Gatus</span><a class="headerlink" href="#id58" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>All pings will be successful except those to the <strong>aws EAST-1</strong> region, as the lack of a <strong>full-mesh</strong> topology impacts connectivity.</p>
</section>
<section id="verify-icmp-traffic-from-bu2-to-bu1-using-ssh-client-bonus">
<h3>9.2 Verify ICMP traffic from bu2 to bu1 Using SSH Client<span style='color:#33ECFF'>(BONUS)</span></summary><a class="headerlink" href="#verify-icmp-traffic-from-bu2-to-bu1-using-ssh-client-bonus" title="Link to this heading">#</a></h3>
<p>SSH to the Public IP of the instance <strong><em>azure-west-us-spoke<span style='color:#479608'>2</span>-<span style='color:#479608'>test1</span></em></strong>.</p>
<p>Ping the following instances:</p>
<ul class="simple">
<li><p><strong>aws-us-east-2-spoke1-test1</strong> in AWS</p></li>
<li><p><strong>aws-us-east-2-spoke1-test2</strong> in AWS</p></li>
<li><p><strong>gcp-us-central1-spoke1-test1</strong> in GCP</p></li>
<li><p><strong>azure-west-us-spoke1-test1</strong> in Azure</p></li>
</ul>
<p>Thit time all pings will be successful, thanks to the inter-rule applied between bu2 and bu1.</p>
<figure class="align-center" id="id59">
<img alt="../_images/lab10-pingallok.png" src="../_images/lab10-pingallok.png" />
<figcaption>
<p><span class="caption-number">Fig. 582 </span><span class="caption-text">Ping ok</span><a class="headerlink" href="#id59" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p><strong>AWS US-EAST-1</strong> region is not reachable yet!</p>
<figure class="align-center" id="id60">
<img alt="../_images/lab10-pingallokk.png" src="../_images/lab10-pingallokk.png" />
<figcaption>
<p><span class="caption-number">Fig. 583 </span><span class="caption-text">Ping fails</span><a class="headerlink" href="#id60" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="logs-monitor">
<h2>10. Logs Monitor<a class="headerlink" href="#logs-monitor" title="Link to this heading">#</a></h2>
<p>Let’s investigate the logs once again.</p>
<p>Go to <strong>CoPilot &gt; Security &gt; Distributed Cloud Firewall &gt; Monitor</strong></p>
<p>Filter out based on the <strong>inter-icmp-bu2-bu1</strong> Rule!</p>
<figure class="align-center" id="id61">
<a class="reference internal image-reference" href="../_images/lab10-monitorfresh.png"><img alt="../_images/lab10-monitorfresh.png" src="../_images/lab10-monitorfresh.png" style="height: 150px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 584 </span><span class="caption-text">Monitor</span><a class="headerlink" href="#id61" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The logs clearly show that the inter-rule is successfully allowing ICMP traffic from bu2 to bu1.</p>
<p>After establishing this inter-rule, the topology with all permitted protocols will be represented as follows:</p>
<figure class="align-center" id="id62">
<a class="reference internal image-reference" href="../_images/lab10-lastdrawing2.png"><img alt="../_images/lab10-lastdrawing2.png" src="../_images/lab10-lastdrawing2.png" style="height: 400px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 585 </span><span class="caption-text">New Topology with the DCF rules</span><a class="headerlink" href="#id62" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The last inter-rule works smoothly only because the ICMP traffic is generated from the bu2, however, if you SSH to any instances in the Smart Group bu1, the ICMP traffic towards bu2 will fail due to the direction of the inter-rule that was created before: <strong>FROM</strong> bu2 <strong>TO</strong> bu1 (please note the direction of the arrow in the drawing).</p>
</div>
<figure class="align-center" id="id63">
<img alt="../_images/lab10-direction.png" src="../_images/lab10-direction.png" />
<figcaption>
<p><span class="caption-number">Fig. 586 </span><span class="caption-text">From-To</span><a class="headerlink" href="#id63" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The inter-rule is <strong>Stateful</strong>, meaning it allows the echo-reply generated from bu1 to reach the instance in bu2.</p>
</section>
<section id="east-1-and-the-multi-tier-transit">
<h2>11. East-1 and the Multi-Tier Transit<a class="headerlink" href="#east-1-and-the-multi-tier-transit" title="Link to this heading">#</a></h2>
<section id="activation-of-the-mtt">
<h3>11.1 Activation of the MTT<a class="headerlink" href="#activation-of-the-mtt" title="Link to this heading">#</a></h3>
<p>Let’s now include the AWS region <strong>US-EAST-1</strong>.</p>
<p>This time, you need to permit ICMP traffic exclusively between the Smart Group <strong>bu2</strong> and the EC2 instance <strong><em>aws-us-east-1-spoke1-test2</em></strong>.</p>
<figure class="align-center" id="id64">
<a class="reference internal image-reference" href="../_images/lab10-newtopology3.png"><img alt="../_images/lab10-newtopology3.png" src="../_images/lab10-newtopology3.png" style="height: 400px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 587 </span><span class="caption-text">New Topology</span><a class="headerlink" href="#id64" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="verification-of-icmp-traffic-between-azure-and-aws-using-gatus-app">
<h3>11.2 Verification of ICMP traffic between Azure and AWS Using Gatus App<a class="headerlink" href="#verification-of-icmp-traffic-between-azure-and-aws-using-gatus-app" title="Link to this heading">#</a></h3>
<p>Open the Gatus App on <strong><em>azure-west-us-spoke2-test1</em></strong> and verify the ICMP Traffic.</p>
<figure class="align-center" id="id65">
<img alt="../_images/lab10-gatus334.png" src="../_images/lab10-gatus334.png" />
<figcaption>
<p><span class="caption-number">Fig. 588 </span><span class="caption-text">Gatus</span><a class="headerlink" href="#id65" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Ping towards the <strong><em>aws-us-east-1-spoke1-test1</em></strong> and <strong><em>aws-us-east-1-spoke1-test2</em></strong> will NOT work.</p>
</section>
<section id="verification-icmp-between-azure-and-aws-using-ssh-client-bonus">
<h3>11.3 Verification ICMP between Azure and AWS Using SSH Client<span style='color:#33ECFF'>(BONUS)</span></summary><a class="headerlink" href="#verification-icmp-between-azure-and-aws-using-ssh-client-bonus" title="Link to this heading">#</a></h3>
<p>SSH to the Public IP of the instance <strong><em>azure-west-us-spoke2-test1</em></strong>.</p>
<p>Ping the following instance:</p>
<ul class="simple">
<li><p><strong>aws-us-east-1-spoke1-test2</strong> in AWS</p></li>
</ul>
<figure class="align-center" id="id66">
<img alt="../_images/lab10-pingfails10.png" src="../_images/lab10-pingfails10.png" />
<figcaption>
<p><span class="caption-number">Fig. 589 </span><span class="caption-text">Ping</span><a class="headerlink" href="#id66" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The ping fails!</p>
</section>
</section>
<section id="verification-of-the-mtt">
<h2>12. Verification of the MTT<a class="headerlink" href="#verification-of-the-mtt" title="Link to this heading">#</a></h2>
<p>Let’s check the routing table of the Spoke Gateway <strong><em>azure-west-us-spoke2</em></strong>.</p>
<p>Go to <strong>CoPilot &gt; Cloud Fabric &gt; Gateways &gt; Spoke Gateways &gt;</strong> select the gateway <strong><em>azure-west-us-spoke2</em></strong></p>
<figure class="align-center" id="id67">
<img alt="../_images/lab10-spoke2azure.png" src="../_images/lab10-spoke2azure.png" />
<figcaption>
<p><span class="caption-number">Fig. 590 </span><span class="caption-text">azure-west-us-spoke2</span><a class="headerlink" href="#id67" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Then click on the <code class="docutils literal notranslate"><span class="pre">&quot;Gateway</span> <span class="pre">Routes&quot;</span></code> tab and check whether the destination route (i.e. <strong>10.0.12.0/23</strong>) is present in the routing table or not.</p>
<figure class="align-center" id="id68">
<img alt="../_images/lab10-gatewayroutes.png" src="../_images/lab10-gatewayroutes.png" />
<figcaption>
<p><span class="caption-number">Fig. 591 </span><span class="caption-text">Gateway Routes</span><a class="headerlink" href="#id68" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id69">
<a class="reference internal image-reference" href="../_images/lab10-newjoe20.png"><img alt="../_images/lab10-newjoe20.png" src="../_images/lab10-newjoe20.png" style="height: 300px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 592 </span><span class="caption-text">10.0.12.0</span><a class="headerlink" href="#id69" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The destination route is <strong>NOT</strong> present in the routing table because the Transit Gateway in the AWS US-EAST-1 region has only one peering connection with the Transit Gateway in the AWS US-EAST-2 region. As a result, the Controller will only install the routes from US-EAST-1 into the routing tables of the Gateways in AWS US-EAST-2, excluding the other Gateways in the MCNA. If you want to distribute the routes from the AWS US-EAST-1 region throughout the entire MCNA, you have <ins>two options</ins>:</p>
</div>
<ul>
<li><p>Enabling <code class="docutils literal notranslate"><span class="pre">&quot;Full-Mesh&quot;</span></code> on the Transit Gateways in <strong><em>aws-us-east1-transit</em></strong> VPC</p>
<p><strong>OR</strong></p>
</li>
<li><p>Enabling <code class="docutils literal notranslate"><span class="pre">&quot;Multi-Tier</span> <span class="pre">Transit&quot;</span></code></p></li>
</ul>
<p>Let’s enable the <strong>MTT</strong> feature and observe its behavior in action!</p>
<p>Go to <strong>CoPilot &gt; Cloud Fabric &gt; Gateways &gt; Transit Gateways</strong> and click on the Transit Gateway <strong><em>aws-us-east-1-transit</em></strong>.</p>
<figure class="align-center" id="id70">
<img alt="../_images/lab10-mtt.png" src="../_images/lab10-mtt.png" />
<figcaption>
<p><span class="caption-number">Fig. 593 </span><span class="caption-text">aws-us-east-1-transit</span><a class="headerlink" href="#id70" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Go to <code class="docutils literal notranslate"><span class="pre">&quot;Settings&quot;</span></code> tab and expand the <code class="docutils literal notranslate"><span class="pre">&quot;“Border</span> <span class="pre">Gateway</span> <span class="pre">Protocol</span> <span class="pre">(BGP)”</span></code> section and insert the AS number <strong>64512</strong> on the empty field related to the <code class="docutils literal notranslate"><span class="pre">&quot;“Local</span> <span class="pre">AS</span> <span class="pre">Number”</span></code>, then click on <strong>Save</strong>.</p>
<figure class="align-center" id="id71">
<a class="reference internal image-reference" href="../_images/lab10-mtt2.png"><img alt="../_images/lab10-mtt2.png" src="../_images/lab10-mtt2.png" style="height: 300px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 594 </span><span class="caption-text">Border Gateway Protocol (BGP)</span><a class="headerlink" href="#id71" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Repeat the previous action for the last Transit Gateway still without a BGP ASN configured properly:</p>
<ul class="simple">
<li><p><strong>azure-west-us-transit</strong>: <span style='color:#479608'>ASN <strong>64515</strong></span></p></li>
</ul>
<figure class="align-center" id="id72">
<img alt="../_images/lab10-newlab.png" src="../_images/lab10-newlab.png" />
<figcaption>
<p><span class="caption-number">Fig. 595 </span><span class="caption-text">azure-west-us-transit</span><a class="headerlink" href="#id72" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Both the <strong>aws-us-east-2-transit</strong> and <strong>gcp-us-central1-transit</strong> have already been configured with their ASNs during Lab 8!</p>
</div>
<p>Go to <strong>CoPilot &gt; Cloud Fabric &gt; Gateways &gt; Transit Gateways</strong> and click on the Transit Gateway <strong><em>aws-us-east-2-transit</em></strong>.</p>
<figure class="align-center" id="id73">
<img alt="../_images/lab10-mtt3.png" src="../_images/lab10-mtt3.png" />
<figcaption>
<p><span class="caption-number">Fig. 596 </span><span class="caption-text">aws-us-east-2-transit</span><a class="headerlink" href="#id73" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Navigate to the <code class="docutils literal notranslate"><span class="pre">&quot;Settings&quot;</span></code> tab, expand the <code class="docutils literal notranslate"><span class="pre">&quot;General&quot;</span></code> section, and activate <code class="docutils literal notranslate"><span class="pre">&quot;Multi-Tier</span> <span class="pre">Transit&quot;</span></code> by toggling the corresponding switch.</p>
<p>Then click on <strong>Save</strong>.</p>
<figure class="align-center" id="id74">
<img alt="../_images/lab10-mtt4.png" src="../_images/lab10-mtt4.png" />
<figcaption>
<p><span class="caption-number">Fig. 597 </span><span class="caption-text">Multi-Tier Transit</span><a class="headerlink" href="#id74" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Let’s verify once again the routing table of the Spoke Gateway in <strong><em>azure-west-us-spoke2</em></strong>.</p>
<p>Go to <strong>CoPilot &gt; Cloud Fabric &gt; Gateways &gt; Spoke Gateways &gt;</strong> select the relevant gateway <strong><em>azure-west-us-spoke2</em></strong></p>
<figure class="align-center" id="id75">
<img alt="../_images/lab10-mtt5.png" src="../_images/lab10-mtt5.png" />
<figcaption>
<p><span class="caption-number">Fig. 598 </span><span class="caption-text">azure-west-us-spoke2</span><a class="headerlink" href="#id75" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>This time if you click on the <code class="docutils literal notranslate"><span class="pre">&quot;Gateway</span> <span class="pre">Routes&quot;</span></code> tab, you will be able to see the destination route, <strong>10.0.12.0/23</strong>, in <strong>aws-us-east1-spoke1</strong> VPC.</p>
<figure class="align-center" id="id76">
<a class="reference internal image-reference" href="../_images/lab10-mtt6.png"><img alt="../_images/lab10-mtt6.png" src="../_images/lab10-mtt6.png" style="height: 300px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 599 </span><span class="caption-text">10.0.12.0/23</span><a class="headerlink" href="#id76" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Click on <code class="docutils literal notranslate"><span class="pre">&quot;+</span> <span class="pre">230</span> <span class="pre">more&quot;</span></code></p>
</div>
</section>
<section id="the-last-dcf-rule">
<h2>13. The last DCF rule<a class="headerlink" href="#the-last-dcf-rule" title="Link to this heading">#</a></h2>
<section id="icmp-verification-traffic-between-azure-and-aws-using-gatus-app-after-enabling-mtt">
<h3>13.1 ICMP Verification  traffic between Azure and AWS Using Gatus App after enabling MTT<a class="headerlink" href="#icmp-verification-traffic-between-azure-and-aws-using-gatus-app-after-enabling-mtt" title="Link to this heading">#</a></h3>
<p>Open the Gatus App on <strong><em>azure-west-us-spoke2-test1</em></strong> and verify the ICMP Traffic.</p>
<figure class="align-center" id="id77">
<img alt="../_images/lab10-gatus334.png" src="../_images/lab10-gatus334.png" />
<figcaption>
<p><span class="caption-number">Fig. 600 </span><span class="caption-text">Gatus</span><a class="headerlink" href="#id77" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Pinging <strong><em>aws-us-east-1-spoke1-test1</em></strong> and <strong><em>aws-us-east-1-spoke1-test2</em></strong> is still not working.</p>
</section>
<section id="icmp-verification-between-azure-and-aws-using-ssh-client-after-enabling-mtt-bonus">
<h3>13.2 ICMP Verification between Azure and AWS Using SSH Client after enabling MTT<span style='color:#33ECFF'>(BONUS)</span></summary><a class="headerlink" href="#icmp-verification-between-azure-and-aws-using-ssh-client-after-enabling-mtt-bonus" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>SSH to the Public IP of the instance <strong><em>azure-west-us-spoke2-test1</em></strong>.</p></li>
</ul>
<p>Ping the following instance:</p>
<ul class="simple">
<li><p><strong>aws-us-east-1-spoke1-test2</strong> in AWS (refer to your personal POD portal for the private IP).</p></li>
</ul>
<figure class="align-center" id="id78">
<img alt="../_images/lab10-mtt7.png" src="../_images/lab10-mtt7.png" />
<figcaption>
<p><span class="caption-number">Fig. 601 </span><span class="caption-text">Ping</span><a class="headerlink" href="#id78" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="final-considerations">
<h2>14. Final Considerations<a class="headerlink" href="#final-considerations" title="Link to this heading">#</a></h2>
<p>Although there is now a valid route to the destination, thanks to the <strong>MTT</strong> feature, the pings are still failing.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The reason is that the EC2 instance <strong>aws-us-east-1-spoke1-test2</strong> has not been allocated to any Smart Groups yet.</p>
</div>
<section id="smart-group-east1">
<h3>14.1 Smart Group “east1”<a class="headerlink" href="#smart-group-east1" title="Link to this heading">#</a></h3>
<p>Let’s create an additional Smart Group for the test instance <strong><em>aws-us-east-1-spoke1-test2</em></strong> in the US-EAST-1 region of AWS.</p>
<p>Go to <strong>Copilot &gt; Groups &gt; SmartGroups</strong> and click on  <code class="docutils literal notranslate"><span class="pre">&quot;+</span> <span class="pre">SmartGroup&quot;</span></code> button.</p>
<figure class="align-center" id="id79">
<img alt="../_images/lab10-mttnew.png" src="../_images/lab10-mttnew.png" />
<figcaption>
<p><span class="caption-number">Fig. 602 </span><span class="caption-text">New Smart Group</span><a class="headerlink" href="#id79" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Ensure these parameters are entered in the pop-up window <code class="docutils literal notranslate"><span class="pre">&quot;Create</span> <span class="pre">SmartGroup&quot;</span></code>:</p>
<ul class="simple">
<li><p><strong>Name</strong>: <span style='color:#479608'>east1</span></p></li>
<li><p><strong>Virtual Machines/Name</strong>: <span style='color:#479608'>aws-us-east-1-spoke1-test2</span></p></li>
</ul>
<figure class="align-center" id="id80">
<img alt="../_images/lab10-mtt9.png" src="../_images/lab10-mtt9.png" />
<figcaption>
<p><span class="caption-number">Fig. 603 </span><span class="caption-text">Resource Selection</span><a class="headerlink" href="#id80" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>CoPilot indicates that there is only one instance that matches the condition:</p>
<ul class="simple">
<li><p>aws-us-east-1-spoke1-test2 in AWS</p></li>
</ul>
<p>Make sure to click <strong>Save</strong> once you’re done.</p>
</section>
<section id="create-an-inter-rule-that-allows-icmp-from-bu2-towards-east1">
<h3>14.2 Create an inter-rule that allows ICMP from bu2 towards east1<a class="headerlink" href="#create-an-inter-rule-that-allows-icmp-from-bu2-towards-east1" title="Link to this heading">#</a></h3>
<p>Go to <strong>CoPilot &gt; Security &gt; Distributed Cloud Firewall &gt; Rules (default tab)</strong> and create another rule clicking on the <code class="docutils literal notranslate"><span class="pre">&quot;+</span> <span class="pre">Rule&quot;</span></code> button.</p>
<figure class="align-center" id="id81">
<img alt="../_images/lab10-mtt8.png" src="../_images/lab10-mtt8.png" />
<figcaption>
<p><span class="caption-number">Fig. 604 </span><span class="caption-text">New Rule</span><a class="headerlink" href="#id81" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Ensure these parameters are entered in the pop-up window <code class="docutils literal notranslate"><span class="pre">&quot;Create</span> <span class="pre">Rule&quot;</span></code>:</p>
<ul class="simple">
<li><p><strong>Name</strong>: <span style='color:#479608'>inter-icmp-bu2-east1</span></p></li>
<li><p><strong>Source Smartgroups</strong>: <span style='color:#479608'>bu2</span></p></li>
<li><p><strong>Destination Smartgroups</strong>: <span style='color:#479608'>east1</span></p></li>
<li><p><strong>Protocol</strong>: <span style='color:#479608'>ICMP</span></p></li>
<li><p><strong>Logging</strong>: <span style='color:#479608'>On</span></p></li>
<li><p><strong>Action</strong>: <span style='color:#479608'><strong>Permit</strong></span></p></li>
</ul>
<p>Then click on <strong>Save In Drafts</strong>.</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>Please note the direction of this new inter-rule:</p>
<p><strong>FROM</strong> bu2 <strong>TO</strong> east1</p>
</div>
<figure class="align-center" id="id82">
<img alt="../_images/lab10-lastrule.png" src="../_images/lab10-lastrule.png" />
<figcaption>
<p><span class="caption-number">Fig. 605 </span><span class="caption-text">The Last Rule…</span><a class="headerlink" href="#id82" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Now you can carry on with the last <strong>commit</strong>!</p>
<figure class="align-center" id="id83">
<a class="reference internal image-reference" href="../_images/lab10-lastcommit.png"><img alt="../_images/lab10-lastcommit.png" src="../_images/lab10-lastcommit.png" style="height: 300px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 606 </span><span class="caption-text">Commit</span><a class="headerlink" href="#id83" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="verify-connectivity-between-bu2-and-east1">
<h3>14.3 Verify connectivity between bu2 and east1<a class="headerlink" href="#verify-connectivity-between-bu2-and-east1" title="Link to this heading">#</a></h3>
<section id="icmp-verification-traffic-between-azure-and-aws-using-gatus-app-after-enabled-mtt">
<h4>14.3.1 ICMP Verification  traffic between Azure and AWS Using Gatus App after enabled MTT<a class="headerlink" href="#icmp-verification-traffic-between-azure-and-aws-using-gatus-app-after-enabled-mtt" title="Link to this heading">#</a></h4>
<p>Open the Gatus App on <strong><em>azure-west-us-spoke2-test1</em></strong> and verify the ICMP Traffic to <strong><em>aws-us-east-1-spoke1-test2</em></strong></p>
<figure class="align-center" id="id84">
<img alt="../_images/lab10-gatus345.png" src="../_images/lab10-gatus345.png" />
<figcaption>
<p><span class="caption-number">Fig. 607 </span><span class="caption-text">Gatus</span><a class="headerlink" href="#id84" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The ICMP traffic test will gradually turn green!</p>
</section>
<section id="icmp-verification-between-azure-and-aws-using-ssh-client-after-enabled-mtt-bonus">
<h4>14.3.2 ICMP Verification between Azure and AWS Using SSH Client after enabled MTT<span style='color:#33ECFF'>(BONUS)</span></summary><a class="headerlink" href="#icmp-verification-between-azure-and-aws-using-ssh-client-after-enabled-mtt-bonus" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>SSH to the Public IP of the instance <strong><em>azure-west-us-spoke2-test1</em></strong> and ping the private IP of the ec2-instance <strong><em>aws-us-east-1-spoke1-test2</em></strong></p></li>
</ul>
<figure class="align-center" id="id85">
<img alt="../_images/lab10-lastping.png" src="../_images/lab10-lastping.png" />
<figcaption>
<p><span class="caption-number">Fig. 608 </span><span class="caption-text">Ping</span><a class="headerlink" href="#id85" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>This time, the ping will be successful!</p>
</section>
<section id="id3">
<h4>14.3.3 Logs<a class="headerlink" href="#id3" title="Link to this heading">#</a></h4>
<p>Check the logs once again.</p>
<p>Go to <strong>CoPilot &gt; Security &gt; Distributed Cloud Firewall &gt; Monitor</strong></p>
<figure class="align-center" id="id86">
<a class="reference internal image-reference" href="../_images/lab10-reallylast.png"><img alt="../_images/lab10-reallylast.png" src="../_images/lab10-reallylast.png" style="height: 200px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 609 </span><span class="caption-text">inter-icmp-bu2-east1 Logs</span><a class="headerlink" href="#id86" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>After creating both the previous inter-rule and the additional Smart Groups, the topology with all permitted protocols will appear as follows:</p>
<figure class="align-center" id="id87">
<a class="reference internal image-reference" href="../_images/lab10-newjoe.png"><img alt="../_images/lab10-newjoe.png" src="../_images/lab10-newjoe.png" style="height: 400px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 610 </span><span class="caption-text">Final Topology</span><a class="headerlink" href="#id87" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>
</section>
<section id="spoke-to-spoke-attachment">
<h2>15. Spoke to Spoke Attachment<a class="headerlink" href="#spoke-to-spoke-attachment" title="Link to this heading">#</a></h2>
<p>Now that you have enabled the Distributed Cloud Firewall, the owner of the <strong><em>azure-west-us-spoke2-test1</em></strong> VM would like to communicate directly with the nearby <strong><em>azure-west-us-spoke1-test1</em></strong> VM, avoding that the traffic generated from the VNet is sent to the NGFW, first.</p>
<figure class="align-center" id="id88">
<img alt="../_images/lab10-spoke2spoke01.png" src="../_images/lab10-spoke2spoke01.png" />
<figcaption>
<p><span class="caption-number">Fig. 611 </span><span class="caption-text">No More NGFW</span><a class="headerlink" href="#id88" title="Link to this image">#</a></p>
</figcaption>
</figure>
<section id="creating-a-spoke-to-spoke-attachment">
<h3>15.1 Creating a Spoke to Spoke Attachment<a class="headerlink" href="#creating-a-spoke-to-spoke-attachment" title="Link to this heading">#</a></h3>
<p>Go to <strong>Copilot &gt; Cloud Fabric &gt; Gateways &gt; Spoke Gateways</strong>, locate the <strong><em>azure-west-us-spoke2</em></strong> gateway and click on the <strong><code class="docutils literal notranslate"><span class="pre">Manage</span> <span class="pre">Gateway</span> <span class="pre">Attachments</span></code></strong> icon on the right-hand side.</p>
<figure class="align-center" id="id89">
<a class="reference internal image-reference" href="../_images/lab10-spoke2spoke02.png"><img alt="../_images/lab10-spoke2spoke02.png" src="../_images/lab10-spoke2spoke02.png" style="height: 200px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 612 </span><span class="caption-text">Manage Gateway Attachments</span><a class="headerlink" href="#id89" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Select the <strong>Spoke Gateway</strong> tab, click on the <code class="docutils literal notranslate"><span class="pre">&quot;+</span> <span class="pre">Attachment&quot;</span></code> button and then choose the <strong>azure-west-us-spoke1</strong> GW from the drop-down window.</p>
<figure class="align-center" id="id90">
<img alt="../_images/lab10-spoke2spoke03.png" src="../_images/lab10-spoke2spoke03.png" />
<figcaption>
<p><span class="caption-number">Fig. 613 </span><span class="caption-text">azure-west-us-spoke2</span><a class="headerlink" href="#id90" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id91">
<img alt="../_images/lab10-newspokeatt.png" src="../_images/lab10-newspokeatt.png" />
<figcaption>
<p><span class="caption-number">Fig. 614 </span><span class="caption-text">Save</span><a class="headerlink" href="#id91" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Do not forget to click on <strong>Save</strong>.</p>
<p>Now go to <strong>CoPilot &gt; Cloud Fabric &gt; Topology</strong> and check the new attachment between the two Spoke Gateways in Azure.</p>
<figure class="align-center" id="id92">
<img alt="../_images/lab10-spoke2spoke04.png" src="../_images/lab10-spoke2spoke04.png" />
<figcaption>
<p><span class="caption-number">Fig. 615 </span><span class="caption-text">Spoke to Spoke Attachment</span><a class="headerlink" href="#id92" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>It will take approximately <strong>2</strong> minutes to reflect into the Dynamic Topology.</p>
</div>
<p>Let’s check the <strong>Routing Table</strong> of the <strong><em>Spoke2</em></strong> in Azure.</p>
<p>Go to <strong>CoPilot &gt; Cloud Fabric &gt; Gateways</strong>, select the <strong>azure-west-us-spoke2</strong>, then select the <strong>Gateways Routes</strong> tab and search for the subnet <strong><code class="docutils literal notranslate"><span class="pre">192.168.1.0</span></code></strong> on the right-hand side.</p>
<figure class="align-center" id="id93">
<img alt="../_images/lab10-spoke2spoke05.png" src="../_images/lab10-spoke2spoke05.png" />
<figcaption>
<p><span class="caption-number">Fig. 616 </span><span class="caption-text">azure-west-us-spoke2</span><a class="headerlink" href="#id93" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>You will notice that the destination is now reachable with a <strong>lower</strong> metric (50)!</p>
<figure class="align-center" id="id94">
<a class="reference internal image-reference" href="../_images/lab10-spoke2spoke06.png"><img alt="../_images/lab10-spoke2spoke06.png" src="../_images/lab10-spoke2spoke06.png" style="height: 300px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 617 </span><span class="caption-text">Metric 50</span><a class="headerlink" href="#id94" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The traffic generated from the <strong><em>azure-west-us-spoke2-test1</em></strong> VM will now prefer going through the Spoke-to-Spoke Attachment for communication with the Spoke1 VNet.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The Aviatrix Cloud Fabric is very flexible and does not lock you in with solely a <em>Hub and Spoke</em> Topology!</p>
</div>
<figure class="align-center" id="id95">
<img alt="../_images/lab10-spoke2spoke07.png" src="../_images/lab10-spoke2spoke07.png" />
<figcaption>
<p><span class="caption-number">Fig. 618 </span><span class="caption-text">Spoke to Spoke</span><a class="headerlink" href="#id95" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>After this lab, the overall topology will look like this:</p>
<figure class="align-center" id="id96">
<a class="reference internal image-reference" href="../_images/lab10-lastdrawing.png"><img alt="../_images/lab10-lastdrawing.png" src="../_images/lab10-lastdrawing.png" style="height: 400px;" />
</a>
<figcaption>
<p><span class="caption-number">Fig. 619 </span><span class="caption-text">Full-Blown Aviatrix Solution</span><a class="headerlink" href="#id96" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./docs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="lab10.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Lab 10 - COSTIQ</p>
      </div>
    </a>
    <a class="right-next"
       href="lab12.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Lab 12 - IAC &amp; NETWORK INSIGHTS API</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#objective">1. Objective</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#distributed-cloud-firewall-overview">2. Distributed Cloud Firewall Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#smart-groups-creation">3. Smart Groups Creation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#smart-group-bu1">3.1 Smart Group “bu1”</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#smart-group-bu2">3.2 Smart Group “bu2”</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#connectivity-verification-icmp-using-gatus-app">3.3 Connectivity Verification (ICMP) Using Gatus App</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#connectivity-verification-icmp-using-ssh-client-bonus">3.4 Connectivity Verification (ICMP) Using SSH Client <span style="color:#33ECFF">(BONUS)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#connectivity-verification-ssh-using-gatus-app">3.5 Connectivity Verification (SSH) Using Gatus App</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#connectivity-verification-ssh-using-ssh-client-bonus">3.6  Connectivity Verification (SSH) Using SSH Client <span style="color:#33ECFF">(BONUS)</span></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dcf-rules-creation">4. DCF Rules Creation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-an-intra-rule-that-allows-icmp-inside-bu1">4.1. Create an intra-rule that allows ICMP inside bu1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-an-intra-rule-that-allows-icmp-inside-bu2">4.2. Create an intra-rule that allows ICMP inside bu2</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#verification">5. Verification</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verify-icmp-within-bu1-and-from-bu1-towards-bu2-using-the-gatus-app">5.1 Verify ICMP within bu1 and from bu1 towards bu2 Using the Gatus App</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verify-ssh-traffic-from-your-laptop-to-bu1-using-ssh-client-bonus">5.2 Verify SSH traffic from your laptop to bu1 Using SSH Client <span style="color:#33ECFF">(BONUS)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verify-icmp-within-bu1-and-from-bu1-towards-bu2-using-the-ssh-client-bonus">5.3 Verify ICMP within bu1 and from bu1 towards bu2 Using the SSH Client <span style="color:#33ECFF">(BONUS)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sg-orchestration">5.4 SG Orchestration</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sg-orchestration-verification-using-the-gatus-app">5.5 SG Orchestration Verification Using the Gatus App</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sg-orchestration-verification-using-the-ssh-client-bonus">5.6 SG Orchestration Verification Using the SSH Client <span style="color:#33ECFF">(BONUS)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verify-ssh-within-bu1-using-the-gatus-app">5.7 Verify SSH within bu1 Using the Gatus App</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verify-ssh-within-bu1-using-the-ssh-client-bonus">5.8 Verify SSH within bu1 Using the SSH Client <span style="color:#33ECFF">(BONUS)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#add-a-rule-that-allows-ssh-in-bu1">5.9 Add a rule that allows SSH in bu1</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#verification-after-the-intra-rule">6. Verification after the intra-rule</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">6.1 Verify SSH within bu1 Using the Gatus App</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">6.2 Verify SSH within bu1 Using the SSH Client <span style="color:#33ECFF">(BONUS)</span></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#logs">7. Logs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#verification-inside-bu2">8.  Verification inside bu2</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verify-icmp-traffic-within-bu2-using-gatus-app">8.1 Verify ICMP traffic within bu2 Using Gatus App</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verify-icmp-traffic-within-bu2-using-ssh-client-bonus">8.2 Verify ICMP traffic within bu2 Using SSH Client<span style="color:#33ECFF">(BONUS)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#logs-verification">8.3 Logs Verification</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inter-rule-from-bu2-to-bu1">9. Inter-rule from bu2 to bu1</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verify-icmp-traffic-from-bu2-to-bu1-using-the-gatus-app">9.1 Verify ICMP traffic from bu2 to bu1 Using the Gatus App</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verify-icmp-traffic-from-bu2-to-bu1-using-ssh-client-bonus">9.2 Verify ICMP traffic from bu2 to bu1 Using SSH Client<span style="color:#33ECFF">(BONUS)</span></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#logs-monitor">10. Logs Monitor</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#east-1-and-the-multi-tier-transit">11. East-1 and the Multi-Tier Transit</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#activation-of-the-mtt">11.1 Activation of the MTT</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verification-of-icmp-traffic-between-azure-and-aws-using-gatus-app">11.2 Verification of ICMP traffic between Azure and AWS Using Gatus App</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verification-icmp-between-azure-and-aws-using-ssh-client-bonus">11.3 Verification ICMP between Azure and AWS Using SSH Client<span style="color:#33ECFF">(BONUS)</span></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#verification-of-the-mtt">12. Verification of the MTT</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-last-dcf-rule">13. The last DCF rule</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#icmp-verification-traffic-between-azure-and-aws-using-gatus-app-after-enabling-mtt">13.1 ICMP Verification  traffic between Azure and AWS Using Gatus App after enabling MTT</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#icmp-verification-between-azure-and-aws-using-ssh-client-after-enabling-mtt-bonus">13.2 ICMP Verification between Azure and AWS Using SSH Client after enabling MTT<span style="color:#33ECFF">(BONUS)</span></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#final-considerations">14. Final Considerations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#smart-group-east1">14.1 Smart Group “east1”</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-an-inter-rule-that-allows-icmp-from-bu2-towards-east1">14.2 Create an inter-rule that allows ICMP from bu2 towards east1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verify-connectivity-between-bu2-and-east1">14.3 Verify connectivity between bu2 and east1</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#icmp-verification-traffic-between-azure-and-aws-using-gatus-app-after-enabled-mtt">14.3.1 ICMP Verification  traffic between Azure and AWS Using Gatus App after enabled MTT</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#icmp-verification-between-azure-and-aws-using-ssh-client-after-enabled-mtt-bonus">14.3.2 ICMP Verification between Azure and AWS Using SSH Client after enabled MTT<span style="color:#33ECFF">(BONUS)</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">14.3.3 Logs</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spoke-to-spoke-attachment">15. Spoke to Spoke Attachment</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-a-spoke-to-spoke-attachment">15.1 Creating a Spoke to Spoke Attachment</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Aviatrix ACE
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>