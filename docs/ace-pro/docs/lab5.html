
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Lab 5 - CLOUD PERIMETER SECURITY (Secure Cloud Egress) &#8212; ACE Operations Lab</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'docs/lab5';</script>
    <link rel="icon" href="../_static/aviatrix-favicon-32.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Lab 6 - FIRENET" href="lab6.html" />
    <link rel="prev" title="Lab 4 - HPE WITH ACTIVE MESH" href="lab4.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="home.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/aviatrix-logo.png" class="logo__image only-light" alt="ACE Operations Lab - Home"/>
    <img src="../_static/aviatrix-logo.png" class="logo__image only-dark pst-js-only" alt="ACE Operations Lab - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="home.html">
                    Welcome to ACE Professional Lab
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="pod.html">POD Portal</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab1.html">Lab 1 - VPCs/VNets CREATION</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab2.html">Lab 2 - TRANSIT NETWORKING</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab3.html">Lab 3 - NETWORK SEGMENTATION</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab4.html">Lab 4 - HPE WITH ACTIVE MESH</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Lab 5 - CLOUD PERIMETER SECURITY (Secure Cloud Egress)</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab6.html">Lab 6 - FIRENET</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab7.html">Lab 7 - SITE2CLOUD</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab8.html">Lab 8 - SECURE HIGH-PERFORMANCE DATACENTER EDGE</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab9.html">Lab 9 - THREAT PREVENTION</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab10.html">Lab 10 - COSTIQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab11.html">Lab 11 - DISTRIBUTED CLOUD FIREWALL</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab12.html">Lab 12 - IAC &amp; NETWORK INSIGHTS API</a></li>
<li class="toctree-l1"><a class="reference internal" href="logos-icons.html">LOGOS-ICONS</a></li>
<li class="toctree-l1"><a class="reference internal" href="PDFs.html">PDFs</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/docs/lab5.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Lab 5 - CLOUD PERIMETER SECURITY (Secure Cloud Egress)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#objective">1. Objective</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#topology">2. Topology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ssh-to-the-ec2-instance-in-the-private-subnet">3. SSH to the EC2 instance in the Private Subnet</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#egress-control">4. Egress Control</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#enable-the-egress-control">4.1 Enable the Egress Control</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-the-private-rtb">4.2 Inspect the Private RTB</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-traffic">4.3 Generate Traffic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#enable-dcf">4.4 Enable DCF</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#identify-the-subnet-where-the-private-workload-resides">4.4.1 Identify the subnet where the private workload resides</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#create-an-ad-hoc-smartgroup">4.4.2 Create an Ad-Hoc SmartGroup</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-new-rule">4.4.3 Create a new Rule</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ztna-zero-trust-network-architecture">5. ZTNA - Zero Trust Network Architecture</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-new-webgroup">5.1 Create a New WebGroup</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-an-editable-explicit-deny-rule">5.2 Create an <em>“editable”</em> Explicit -Deny-Rule</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#enforce-the-egress-rule">5.2.1 Enforce the Egress-Rule</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#create-an-ad-hoc-explicit-deny-rule">5.2.2 Create an <em>ad-hoc</em> Explicit-Deny-Rule</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#test-the-modified-rule">5.3 Test the modified rule</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ids">6. IDS</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">6.1 Create a New Rule</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prepare-the-simulator">6.2 Prepare the simulator</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#test-the-new-rule-and-the-ids-feature">6.3 Test the New Rule and the IDS feature</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="lab-5-cloud-perimeter-security-secure-cloud-egress">
<h1>Lab 5 - CLOUD PERIMETER SECURITY (Secure Cloud Egress)<a class="headerlink" href="#lab-5-cloud-perimeter-security-secure-cloud-egress" title="Link to this heading">#</a></h1>
<section id="objective">
<h2>1. Objective<a class="headerlink" href="#objective" title="Link to this heading">#</a></h2>
<p>In this lab, we will demonstrate how to enable the <code class="docutils literal notranslate"><span class="pre">Cloud</span> <span class="pre">Perimeter</span> <span class="pre">Security</span></code> (<strong>Secure Cloud Egress</strong>), one of the features that belongs to the <em>Distributed Cloud Firewall</em> functionality, on the VPC that we want to target. Of course, the selected VPC should have at least a subnet associated to a Private Routing table (i.e. without a default route pointing to the IGW). The Controller will reroute the traffic through the Aviatrix Spoke Gateway. The Egress Control can guarantee immediately better visibility and better control in order to replace the <strong>CSP Native NAT Gateways</strong>. <ins>Cloud Perimeter Security (Secure Cloud Egress) allows to reduce the cloud costs and at the same time, improve the security without impacting the architecture</ins>.</p>
</section>
<section id="topology">
<h2>2. Topology<a class="headerlink" href="#topology" title="Link to this heading">#</a></h2>
<p>Let’s pinpoint the right candidate VPC where would be possible to enable the Egress Control.</p>
<figure class="align-center" id="id2">
<a class="reference internal image-reference" href="../_images/lab6-initialtopology.png"><img alt="../_images/lab6-initialtopology.png" src="../_images/lab6-initialtopology.png" style="height: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 171 </span><span class="caption-text">Lab 6 Initial Topology</span><a class="headerlink" href="#id2" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The VPC <strong>aws-us-east-2-spoke1</strong> has a private subnet in its environment, whereby the Egress Control can be activated in this specific VPC.</p>
<ul class="simple">
<li><p>Explore the Private Routing Tables inside the VPC <strong>aws-us-east-2-spoke1</strong></p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Go to <strong>CoPilot &gt; Cloud Fabric &gt; Gateways &gt; Spoke Gateways</strong> and select the <strong><em>aws-us-east-2-spoke1 GW</em></strong>, then click on the <strong>VPC/VNet Route Tables</strong> tab, then select any of the Private RTBs from the <code class="docutils literal notranslate"><span class="pre">Route</span> <span class="pre">Table</span></code> field.</p>
</div>
<figure class="align-center" id="id3">
<img alt="../_images/lab6-spokegw.png" src="../_images/lab6-spokegw.png" />
<figcaption>
<p><span class="caption-number">Fig. 172 </span><span class="caption-text">Select the Spoke GW in US-EAST-2</span><a class="headerlink" href="#id3" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id4">
<img alt="../_images/lab6-vpc.png" src="../_images/lab6-vpc.png" />
<figcaption>
<p><span class="caption-number">Fig. 173 </span><span class="caption-text">Check the private RTB</span><a class="headerlink" href="#id4" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>You will notice that any private RTBs has its own <strong>CIDR</strong> pointing to local and the three <strong>RFC1918</strong> routes pointing to the Aviatrix Spoke Gateway.</p>
<p>With this scenario, the EC2 instance can’t reach the <em>Internet Public Zone</em>, due to the absence of a <ins>default route</ins>.</p>
</section>
<section id="ssh-to-the-ec2-instance-in-the-private-subnet">
<h2>3. SSH to the EC2 instance in the Private Subnet<a class="headerlink" href="#ssh-to-the-ec2-instance-in-the-private-subnet" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>SSH to the <strong><em>aws-us-east-2-spoke1-test1</em></strong> instance from your laptop. Refer to your POD portal or alternatively, you can retrieve the Public IP from the CoPilot’s Topology.</p></li>
</ul>
<figure class="align-center" id="id5">
<a class="reference internal image-reference" href="../_images/lab6-publicip.png"><img alt="../_images/lab6-publicip.png" src="../_images/lab6-publicip.png" style="height: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 174 </span><span class="caption-text">SSH to aws-us-east-2-spoke1-test1</span><a class="headerlink" href="#id5" title="Link to this image">#</a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>Then from the <strong><em>aws-us-east-2-spoke1-test1</em></strong> instance SSH to the <strong><em>aws-us-east-2-spoke1-test2</em></strong> instance.</p></li>
</ul>
<figure class="align-center" id="id6">
<img alt="../_images/lab6-ssh.png" src="../_images/lab6-ssh.png" />
<figcaption>
<p><span class="caption-number">Fig. 175 </span><span class="caption-text">From test1 to test2</span><a class="headerlink" href="#id6" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <strong><em>aws-us-east-2-spoke1-test2</em></strong> instance resides within a private subnet!</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Retrieve the Private IP of the <strong><em>aws-us-east-2-spoke1-test2</em></strong> from the Topology</p>
</div>
<figure class="align-center" id="id7">
<a class="reference internal image-reference" href="../_images/lab6-retrieve.png"><img alt="../_images/lab6-retrieve.png" src="../_images/lab6-retrieve.png" style="height: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 176 </span><span class="caption-text">Retrieve the private IP</span><a class="headerlink" href="#id7" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="egress-control">
<h2>4. Egress Control<a class="headerlink" href="#egress-control" title="Link to this heading">#</a></h2>
<section id="enable-the-egress-control">
<h3>4.1 Enable the Egress Control<a class="headerlink" href="#enable-the-egress-control" title="Link to this heading">#</a></h3>
<p>Now let’s enable the egress within the VPC that is hosting the <strong><em>aws-us-east-2-spoke1-test2</em></strong> instance.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Go to <strong>CoPilot &gt; Security &gt; Egress &gt; Egress VPC/VNets</strong> and click on <code class="docutils literal notranslate"><span class="pre">&quot;Enable</span> <span class="pre">Local</span> <span class="pre">Egress</span> <span class="pre">on</span> <span class="pre">VPC/VNets&quot;</span></code>, then select the <strong><em>aws-us-east-2-spoke1</em></strong> VPC and click on <strong>Add</strong>.</p>
</div>
<figure class="align-center" id="id8">
<img alt="../_images/lab6-egress.png" src="../_images/lab6-egress.png" />
<figcaption>
<p><span class="caption-number">Fig. 177 </span><span class="caption-text">Enable Local Egress</span><a class="headerlink" href="#id8" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id9">
<img alt="../_images/lab6-vpcegress.png" src="../_images/lab6-vpcegress.png" />
<figcaption>
<p><span class="caption-number">Fig. 178 </span><span class="caption-text">Choose the correct VPC</span><a class="headerlink" href="#id9" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="inspect-the-private-rtb">
<h3>4.2 Inspect the Private RTB<a class="headerlink" href="#inspect-the-private-rtb" title="Link to this heading">#</a></h3>
<p>Upon enabling Local Egress on the specified VPC, the Aviatrix Controller will immediately execute two actions on the specified VPC:</p>
<ul class="simple">
<li><p>Injecting a <strong>Default Route</strong>: this route is added exclusively to the Private Route Tables (RTBs). Public Route Tables (RTBs) remain unaffected and will continue to have their default route pointing towards the native Cloud Service Provider (CSP) Internet Gateway (<strong>IGW</strong>).</p></li>
<li><p>Enabling <strong>Single IP SNAT</strong> on VPC Spoke Gateway: Source Network Address Translation (SNAT) will be enabled on the VPC spoke gateway using a single IP address.</p></li>
</ul>
<p>At this point, the Aviatrix  performs the same functions as the <strong>CSP NAT Gateway</strong>.</p>
<ul class="simple">
<li><p>Verify its presence in any Private RTBs inside the <strong><em>aws-us-east-2-spoke1</em></strong> VPC.</p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Go to <strong>CoPilot &gt; Cloud Fabric &gt; Gateways &gt; Spoke Gateways</strong> and select the <strong><em>aws-us-east-2-spoke1 GW</em></strong>, then click on the <strong>VPC/VNet Route Tables</strong> tab, then select any Private RTBs from the <strong>Route Table</strong> field.</p>
</div>
<figure class="align-center" id="id10">
<img alt="../_images/lab6-defaultroute.png" src="../_images/lab6-defaultroute.png" />
<figcaption>
<p><span class="caption-number">Fig. 179 </span><span class="caption-text">Default route has been injected</span><a class="headerlink" href="#id10" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Now, thanks to the default route, the instance <strong><em>aws-us-east-2-spoke1-test2</em></strong> will be able to generate traffic towards the internet public zone.</p>
</div>
</section>
<section id="generate-traffic">
<h3>4.3 Generate Traffic<a class="headerlink" href="#generate-traffic" title="Link to this heading">#</a></h3>
<p>From the <strong><em>aws-us-east-2-spoke1-test2</em></strong> instance, try to curl the following websites:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>www.aviatrix.com
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>www.wikipedia.com
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>www.espn.com
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>www.football.com
</pre></div>
</div>
<figure class="align-center" id="id11">
<img alt="../_images/lab6-generatetraffic.png" src="../_images/lab6-generatetraffic.png" />
<figcaption>
<p><span class="caption-number">Fig. 180 </span><span class="caption-text">Generate traffic</span><a class="headerlink" href="#id11" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Let’s now check whether the Spoke Gateway could gather <strong>NetFlow</strong> data after generating the aforementioned <em>curl</em> commands, or not.</p>
<p>Go to <strong>CoPilot &gt; Security &gt; Egress &gt; Overview (default)</strong></p>
<figure class="align-center" id="id12">
<a class="reference internal image-reference" href="../_images/lab6-nodatafound.png"><img alt="../_images/lab6-nodatafound.png" src="../_images/lab6-nodatafound.png" style="height: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 181 </span><span class="caption-text">No Data Found</span><a class="headerlink" href="#id12" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>You will notice the Message <code class="docutils literal notranslate"><span class="pre">&quot;No</span> <span class="pre">Data</span> <span class="pre">Found&quot;</span></code>. You have successfully activated your egress control without disrupting anything that is sitting on the private subnet, nevertheless, if you want to get the NetFlow information, you need to apply a <code class="docutils literal notranslate"><span class="pre">Distributed</span> <span class="pre">Cloud</span> <span class="pre">Firewall</span> <span class="pre">RULE</span></code>, such that you can start evaluate the behaviour of the Private Subnet and get a good understanding of what domains have been reached out from the private subnet.</p>
</section>
<section id="enable-dcf">
<h3>4.4 Enable DCF<a class="headerlink" href="#enable-dcf" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Enable the Distributed Cloud Firewall.</p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Go to <strong>CoPilot &gt; Security &gt; Distributed Cloud Firewall &gt; Rules</strong> and click on <code class="docutils literal notranslate"><span class="pre">&quot;Enable</span> <span class="pre">Distributed</span> <span class="pre">Cloud</span> <span class="pre">Firewall&quot;</span></code>.
Afterwards click on <code class="docutils literal notranslate"><span class="pre">&quot;Begin</span> <span class="pre">using</span> <span class="pre">Distributed</span> <span class="pre">Cloud</span> <span class="pre">Firewall&quot;</span></code>, then click on <code class="docutils literal notranslate"><span class="pre">&quot;Begin&quot;</span></code>.</p>
</div>
<figure class="align-center" id="id13">
<img alt="../_images/lab6-activate.png" src="../_images/lab6-activate.png" />
<figcaption>
<p><span class="caption-number">Fig. 182 </span><span class="caption-text">Enable Distributed Cloud Firewall</span><a class="headerlink" href="#id13" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id14">
<img alt="../_images/lab6-newjoe.png" src="../_images/lab6-newjoe.png" />
<figcaption>
<p><span class="caption-number">Fig. 183 </span><span class="caption-text">Begin using Distributed Cloud Firewall</span><a class="headerlink" href="#id14" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id15">
<img alt="../_images/lab6-newjoe2.png" src="../_images/lab6-newjoe2.png" />
<figcaption>
<p><span class="caption-number">Fig. 184 </span><span class="caption-text">Begin</span><a class="headerlink" href="#id15" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>After having enabled the DCF, two Rules will get generated, automatically:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Greendfield-Rule</span></code> = ALLOW EVERYTHING</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DefaultDenyAll</span></code> = it’s an EXPLICIT deny</p></li>
</ul>
<p>The first rule essentially allows all kind of traffic.</p>
<figure class="align-center" id="id16">
<a class="reference internal image-reference" href="../_images/lab6-greenfield.png"><img alt="../_images/lab6-greenfield.png" src="../_images/lab6-greenfield.png" style="height: 150px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 185 </span><span class="caption-text">Automatic rules injected by the Controller</span><a class="headerlink" href="#id16" title="Link to this image">#</a></p>
</figcaption>
</figure>
<section id="identify-the-subnet-where-the-private-workload-resides">
<h4>4.4.1 Identify the subnet where the private workload resides<a class="headerlink" href="#identify-the-subnet-where-the-private-workload-resides" title="Link to this heading">#</a></h4>
<p>First and foremost, you have to identify the <strong>public subnet</strong> where the <strong><em>aws-us-east-2-spoke1-test2</em></strong> instance resides.</p>
<figure class="align-center" id="id17">
<a class="reference internal image-reference" href="../_images/lab6-greenfieldneww.png"><img alt="../_images/lab6-greenfieldneww.png" src="../_images/lab6-greenfieldneww.png" style="height: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 186 </span><span class="caption-text">Private Subnet</span><a class="headerlink" href="#id17" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Go to <strong>CoPilot &gt; Cloud Resources &gt; Cloud Assets &gt; Virtual Machines</strong> and search for the <strong><em>aws-us-east-2-spoke1-test2</em></strong> instance on the search field on the right-hand side.</p>
<p>From the outcom you have to pinpoint the <code class="docutils literal notranslate"><span class="pre">Availability</span> <span class="pre">Zone</span></code>.</p>
<figure class="align-center" id="id18">
<a class="reference internal image-reference" href="../_images/lab6-greenfieldneww2.png"><img alt="../_images/lab6-greenfieldneww2.png" src="../_images/lab6-greenfieldneww2.png" style="height: 150px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 187 </span><span class="caption-text">AZ</span><a class="headerlink" href="#id18" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Now that you know in what <code class="docutils literal notranslate"><span class="pre">Availability</span> <span class="pre">Zone</span></code> the private workload resides, you need to select the <code class="docutils literal notranslate"><span class="pre">VPC/VNets</span> <span class="pre">&amp;</span> <span class="pre">Subnets</span></code> TAB and filter out based on the <strong><em>aws-us-east-2-spoke1</em></strong> VPC.</p>
<p>Identify the <code class="docutils literal notranslate"><span class="pre">Private</span> <span class="pre">Subnet</span></code> that belongs to the <code class="docutils literal notranslate"><span class="pre">us-east-2a</span></code> AZ and copy the corresponding <strong><em><code class="docutils literal notranslate"><span class="pre">IP</span> <span class="pre">Address</span> <span class="pre">CIDR</span></code></em></strong> value!</p>
<figure class="align-center" id="id19">
<a class="reference internal image-reference" href="../_images/lab6-greenfieldneww3.png"><img alt="../_images/lab6-greenfieldneww3.png" src="../_images/lab6-greenfieldneww3.png" style="height: 300px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 188 </span><span class="caption-text">Private Subnet</span><a class="headerlink" href="#id19" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="create-an-ad-hoc-smartgroup">
<h4>4.4.2 Create an Ad-Hoc SmartGroup<a class="headerlink" href="#create-an-ad-hoc-smartgroup" title="Link to this heading">#</a></h4>
<p>Go to <strong>CoPilot &gt; Groups</strong> and click on the <code class="docutils literal notranslate"><span class="pre">&quot;+</span> <span class="pre">SmartGroup&quot;</span></code> button.</p>
<figure class="align-center" id="id20">
<a class="reference internal image-reference" href="../_images/lab6-newsg.png"><img alt="../_images/lab6-newsg.png" src="../_images/lab6-newsg.png" style="height: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 189 </span><span class="caption-text">SmartGroup</span><a class="headerlink" href="#id20" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Afterwards, click on the arrow icon  inside the <code class="docutils literal notranslate"><span class="pre">&quot;+</span> <span class="pre">Resource</span> <span class="pre">Type&quot;</span></code> button and select <code class="docutils literal notranslate"><span class="pre">&quot;IP</span> <span class="pre">/</span> <span class="pre">CIDRs&quot;</span></code>.</p>
<figure class="align-center" id="id21">
<a class="reference internal image-reference" href="../_images/lab6-greenfieldneww4.png"><img alt="../_images/lab6-greenfieldneww4.png" src="../_images/lab6-greenfieldneww4.png" style="height: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 190 </span><span class="caption-text">Private Subnet</span><a class="headerlink" href="#id21" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Ensure these parameters are entered in the pop-up window <code class="docutils literal notranslate"><span class="pre">&quot;Create</span> <span class="pre">SmartGroup&quot;</span></code>:</p>
<ul class="simple">
<li><p><strong>Name</strong>: <span style='color:#479608'>us-east-2-private-subnet</span></p></li>
<li><p><strong>IPs / CIDRs</strong>: <span style='color:#479608'>10.0.1.0/27</span></p></li>
</ul>
<p>Before clicking on <strong>SAVE</strong>, delete the empty <code class="docutils literal notranslate"><span class="pre">&quot;Virtual</span> <span class="pre">Machines&quot;</span></code> additional condition.</p>
<figure class="align-center" id="id22">
<a class="reference internal image-reference" href="../_images/lab6-greenfieldneww45.png"><img alt="../_images/lab6-greenfieldneww45.png" src="../_images/lab6-greenfieldneww45.png" style="height: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 191 </span><span class="caption-text">New SG</span><a class="headerlink" href="#id22" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="create-a-new-rule">
<h4>4.4.3 Create a new Rule<a class="headerlink" href="#create-a-new-rule" title="Link to this heading">#</a></h4>
<p>Go to <strong>CoPilot &gt; Security &gt; Distributed Cloud Firewall &gt; Rules (default tab)</strong> and create a new rule clicking on the <code class="docutils literal notranslate"><span class="pre">&quot;+</span> <span class="pre">Rule&quot;</span></code> button.</p>
<figure class="align-center" id="id23">
<img alt="../_images/lab6-newrule10.png" src="../_images/lab6-newrule10.png" />
<figcaption>
<p><span class="caption-number">Fig. 192 </span><span class="caption-text">New Rule</span><a class="headerlink" href="#id23" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Insert the following parameters</p>
<ul class="simple">
<li><p><strong>Name</strong>: <span style='color:#479608'>Egress-Rule</span></p></li>
<li><p><strong>Source Smartgroups</strong>: <span style='color:#479608'>us-east-2-private-subnet</span></p></li>
<li><p><strong>Destination Smartgroups</strong>: <span style='color:#479608'>Public Internet</span></p></li>
<li><p><strong>WebGroups</strong>: <span style='color:#479608'><strong>All-Web</strong></span></p></li>
<li><p><strong>Protocol</strong>: <span style='color:#479608'>Any</span></p></li>
<li><p><strong>Enforcement</strong>: <span style='color:#479608'><strong>Off</strong></span></p></li>
<li><p><strong>Logging</strong>: <span style='color:#479608'>On</span></p></li>
<li><p><strong>Action</strong>: <span style='color:#479608'><strong>Permit</strong></span></p></li>
</ul>
<p>Do not forget to click on <strong>Save In Drafts</strong>.</p>
<figure class="align-center" id="id24">
<img alt="../_images/lab6-new.png" src="../_images/lab6-new.png" />
<figcaption>
<p><span class="caption-number">Fig. 193 </span><span class="caption-text">Saving the new Rule</span><a class="headerlink" href="#id24" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Click on the <strong>Commit</strong> button and the rule previously created will work in <strong><em>watch/test</em></strong> mode due to the fact that the <code class="docutils literal notranslate"><span class="pre">enforcement</span></code> was turn off.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>If the <strong>Enforcement</strong> slider is <strong>On</strong> (the default), the rule is enforced in the data plane. If the Enforcement slider is <strong>Off</strong>, the packets are only watched. This allows you to observe if the traffic impacted by this rule causes any inadvertent issues (such as traffic being dropped).</p>
</div>
<figure class="align-center" id="id25">
<a class="reference internal image-reference" href="../_images/lab6-newrule11.png"><img alt="../_images/lab6-newrule11.png" src="../_images/lab6-newrule11.png" style="height: 250px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 194 </span><span class="caption-text">Egress-Rule</span><a class="headerlink" href="#id25" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Now delete the <strong>Greenfield-Rule</strong>:</p>
<ul class="simple">
<li><p>click on the <strong>three dots</strong> icon on the right-hand side of the Greenfield-Rule entry and then choose the <code class="docutils literal notranslate"><span class="pre">&quot;Delete</span> <span class="pre">Rule&quot;</span></code> option.</p></li>
</ul>
<p>Do not forget to click on <strong>Commit</strong>.</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>The deletion of the Greenfield-Rule will also cause the deletion of the DefaultDenyAll, because the Egress-Rule was not enforced on the data path, which in turn means that there will be an <code class="docutils literal notranslate"><span class="pre">Invisible</span> <span class="pre">Deny</span> <span class="pre">Rule</span></code> installed on the bottom.</p>
</div>
<figure class="align-center" id="id26">
<a class="reference internal image-reference" href="../_images/lab6-newruledelete.png"><img alt="../_images/lab6-newruledelete.png" src="../_images/lab6-newruledelete.png" style="height: 250px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 195 </span><span class="caption-text">Deletion of the Greenfield-Rule</span><a class="headerlink" href="#id26" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id27">
<a class="reference internal image-reference" href="../_images/lab6-newruledeleted.png"><img alt="../_images/lab6-newruledeleted.png" src="../_images/lab6-newruledeleted.png" style="height: 150px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 196 </span><span class="caption-text">Egress-Rule solely</span><a class="headerlink" href="#id27" title="Link to this image">#</a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>Launch again the following curl commands from the instance <strong><em>aws-us-east-2-spoke1-test2</em></strong>.</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>www.aviatrix.com
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>www.wikipedia.com
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>www.espn.com
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>www.football.com
</pre></div>
</div>
<p>Go to <strong>CoPilot &gt; Security &gt; Distributed Cloud Firewall &gt; Monitor</strong> and you will see the corresponding <strong>logs</strong>.</p>
<figure class="align-center" id="id28">
<a class="reference internal image-reference" href="../_images/lab6-monitorpermit.png"><img alt="../_images/lab6-monitorpermit.png" src="../_images/lab6-monitorpermit.png" style="height: 200px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 197 </span><span class="caption-text">Monitor</span><a class="headerlink" href="#id28" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>However, on the SSH client, you will <strong>NOT</strong> see any outputs, this is because the Rule <ins>was not enforced in the Data Path</ins>, therefore the traffic is simply dropped.</p>
</div>
<figure class="align-center" id="id29">
<a class="reference internal image-reference" href="../_images/lab6-monitorpermit22.png"><img alt="../_images/lab6-monitorpermit22.png" src="../_images/lab6-monitorpermit22.png" style="height: 200px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 198 </span><span class="caption-text">SSH client outputs</span><a class="headerlink" href="#id29" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Go to <strong>CoPilot &gt; Security &gt; Egress &gt; Overview (default)</strong></p>
<p>Now you have finally the  <strong>egress observability</strong> with a full list of domains hit by the EC2 instance inside that private subnet.</p>
<figure class="align-center" id="id30">
<a class="reference internal image-reference" href="../_images/lab6-newrul12.png"><img alt="../_images/lab6-newrul12.png" src="../_images/lab6-newrul12.png" style="height: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 199 </span><span class="caption-text">Overview</span><a class="headerlink" href="#id30" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Furthermore, go to <strong>CoPilot &gt; Security &gt; Egress &gt; Monitor</strong> and from the <code class="docutils literal notranslate"><span class="pre">&quot;VPC/VNets&quot;</span></code> drop-down window, select the <strong><em>aws-us-east-2-spoke1 VPC</em></strong>.</p>
<figure class="align-center" id="id31">
<a class="reference internal image-reference" href="../_images/lab6-monitor.png"><img alt="../_images/lab6-monitor.png" src="../_images/lab6-monitor.png" style="height: 250px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 200 </span><span class="caption-text">Monitor</span><a class="headerlink" href="#id31" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>You will get a granular Layer 7 visibility that allows you to get a good understanding of how the egress traffic has been consumed and also allows you to help make decisions on how to potentially optimize that.</p>
</section>
</section>
</section>
<section id="ztna-zero-trust-network-architecture">
<h2>5. ZTNA - Zero Trust Network Architecture<a class="headerlink" href="#ztna-zero-trust-network-architecture" title="Link to this heading">#</a></h2>
<section id="create-a-new-webgroup">
<h3>5.1 Create a New WebGroup<a class="headerlink" href="#create-a-new-webgroup" title="Link to this heading">#</a></h3>
<p>Let’s move towards a posture where only specific egress domains are in place.</p>
<p>Go to <strong>CoPilot &gt; Groups &gt; WebGroups</strong> and click on <code class="docutils literal notranslate"><span class="pre">&quot;+</span> <span class="pre">WebGroup&quot;</span></code> button.</p>
<figure class="align-center" id="id32">
<img alt="../_images/lab6-webgroup.png" src="../_images/lab6-webgroup.png" />
<figcaption>
<p><span class="caption-number">Fig. 201 </span><span class="caption-text">+WebGroup</span><a class="headerlink" href="#id32" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Create a <strong><em>WebGroup</em></strong> with the following parameters:</p>
<ul class="simple">
<li><p><strong>Name</strong>: <span style='color:#479608'>two-domains</span></p></li>
<li><p><strong>Type</strong>: <span style='color:#479608'>Domains</span></p></li>
<li><p><strong>Domains/URLs</strong>: <span style='color:#479608'><a class="reference external" href="http://www.aviatrix.com">www.aviatrix.com</a></span></p></li>
<li><p><strong>Domains/URLs</strong>: <span style='color:#479608'><a class="reference external" href="http://www.wikipedia.com">www.wikipedia.com</a></span></p></li>
</ul>
<p>Do not forget to click on <strong>Save</strong>.</p>
<figure class="align-center" id="id33">
<img alt="../_images/lab6-webgroup2.png" src="../_images/lab6-webgroup2.png" />
<figcaption>
<p><span class="caption-number">Fig. 202 </span><span class="caption-text">WebGroup creation</span><a class="headerlink" href="#id33" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The purpose of this <strong>WebGroup</strong> is to authorize traffic only towards both the Domains <em><code class="docutils literal notranslate"><span class="pre">www.aviatrix.com</span></code></em> and <em><code class="docutils literal notranslate"><span class="pre">www.wikipedia.com</span></code></em>, therefore the curl commands issued towards other Domains will be blocked.</p>
</div>
</section>
<section id="create-an-editable-explicit-deny-rule">
<h3>5.2 Create an <em>“editable”</em> Explicit -Deny-Rule<a class="headerlink" href="#create-an-editable-explicit-deny-rule" title="Link to this heading">#</a></h3>
<section id="enforce-the-egress-rule">
<h4>5.2.1 Enforce the Egress-Rule<a class="headerlink" href="#enforce-the-egress-rule" title="Link to this heading">#</a></h4>
<p>Go to <strong>CoPilot &gt; Security &gt; Distributed Cloud Firewall &gt; Rules</strong>, click on the <strong>pencil</strong> button on the right-hand side of the <code class="docutils literal notranslate"><span class="pre">Egress-Rule</span></code>.</p>
<ul class="simple">
<li><p>Now remove the WebGroup <code class="docutils literal notranslate"><span class="pre">&quot;All-Web&quot;</span></code> and then select the WebGroup <code class="docutils literal notranslate"><span class="pre">&quot;two-domains&quot;</span></code>.</p></li>
<li><p>Turn <strong>ON</strong> the <code class="docutils literal notranslate"><span class="pre">Enforcement</span></code> knob.</p></li>
</ul>
<p>Do not forget to click on <strong>Save In Drafts</strong> and then <strong>Commit</strong> your changes!</p>
<figure class="align-center" id="id34">
<img alt="../_images/lab6-webgroup234.png" src="../_images/lab6-webgroup234.png" />
<figcaption>
<p><span class="caption-number">Fig. 203 </span><span class="caption-text">Editing the Egress-Rule</span><a class="headerlink" href="#id34" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id35">
<a class="reference internal image-reference" href="../_images/lab6-webgroup2345.png"><img alt="../_images/lab6-webgroup2345.png" src="../_images/lab6-webgroup2345.png" style="height: 200px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 204 </span><span class="caption-text">Commit the changes</span><a class="headerlink" href="#id35" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition important">
<p class="admonition-title">Important</p>
<ul class="simple">
<li><p><strong>Anywhere (0.0.0.0/0)</strong> = Represents all CIDR ranges or IP addresses.</p></li>
<li><p><strong>Publlic Internet</strong> = Represents non-RFC 1918 IP ranges, or the public Internet</p></li>
</ul>
</div>
<p>After having successfully enforced the <strong>Egress-Rule</strong> you will notice that automatically ther Controller has applied at the very bottom, the <code class="docutils literal notranslate"><span class="pre">DefaultDenyAll</span></code> rule.</p>
<figure class="align-center" id="id36">
<a class="reference internal image-reference" href="../_images/lab6-webgroup23456.png"><img alt="../_images/lab6-webgroup23456.png" src="../_images/lab6-webgroup23456.png" style="height: 200px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 205 </span><span class="caption-text">Egress-Rule + DefaultDenyAll</span><a class="headerlink" href="#id36" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>However, <ins>this rule is NOT editable</ins>, therefore any matches against the DefaultDenyRule will not generate any logs.</p>
<figure class="align-center" id="id37">
<a class="reference internal image-reference" href="../_images/lab6-defaultdenyall01.png"><img alt="../_images/lab6-defaultdenyall01.png" src="../_images/lab6-defaultdenyall01.png" style="height: 200px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 206 </span><span class="caption-text">Not editable</span><a class="headerlink" href="#id37" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="create-an-ad-hoc-explicit-deny-rule">
<h4>5.2.2 Create an <em>ad-hoc</em> Explicit-Deny-Rule<a class="headerlink" href="#create-an-ad-hoc-explicit-deny-rule" title="Link to this heading">#</a></h4>
<p>Go to <strong>CoPilot &gt; Security &gt; Distributed Cloud Firewall &gt; Rules (default tab)</strong> and create a new rule clicking on the <code class="docutils literal notranslate"><span class="pre">&quot;+</span> <span class="pre">Rule&quot;</span></code> button.</p>
<figure class="align-center" id="id38">
<a class="reference internal image-reference" href="../_images/lab6-defaultdenyall02.png"><img alt="../_images/lab6-defaultdenyall02.png" src="../_images/lab6-defaultdenyall02.png" style="height: 200px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 207 </span><span class="caption-text">Not editable</span><a class="headerlink" href="#id38" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Insert the following parameters</p>
<ul class="simple">
<li><p><strong>Name</strong>: <span style='color:#479608'>Explicit-Deny-Rule</span></p></li>
<li><p><strong>Source Smartgroups</strong>: <span style='color:#479608'>Anywhere (0.0.0.0/0)</span></p></li>
<li><p><strong>Destination Smartgroups</strong>: <span style='color:#479608'>Anywhere (0.0.0.0/0)</span></p></li>
<li><p><strong>Protocol</strong>: <span style='color:#479608'>Any</span></p></li>
<li><p><strong>Enforcement</strong>: <span style='color:#479608'><strong>On</strong></span></p></li>
<li><p><strong>Logging</strong>: <span style='color:#479608'>On</span></p></li>
<li><p><strong>Action</strong>: <span style='color:#479608'><strong>Deny</strong></span></p></li>
<li><p><strong>Rule Priority</strong>:</p>
<ul>
<li><p><strong>Place Rule</strong>: <span style='color:#479608'><strong>Below</strong></span></p></li>
<li><p><strong>Existing Rulee</strong>: <span style='color:#479608'><strong>Egress-Rule</strong></span></p></li>
</ul>
</li>
</ul>
<p>Do not forget to click on <strong>Save In Drafts</strong>.</p>
<figure class="align-center" id="id39">
<img alt="../_images/lab6-defaultdenyall03.png" src="../_images/lab6-defaultdenyall03.png" />
<figcaption>
<p><span class="caption-number">Fig. 208 </span><span class="caption-text"><em>Editable</em> Explicit-Deny-Rule</span><a class="headerlink" href="#id39" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Do not forget to click on <strong>Commit</strong>.</p>
<figure class="align-center" id="id40">
<a class="reference internal image-reference" href="../_images/lab6-defaultdenyall04.png"><img alt="../_images/lab6-defaultdenyall04.png" src="../_images/lab6-defaultdenyall04.png" style="height: 200px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 209 </span><span class="caption-text">Commit your changes</span><a class="headerlink" href="#id40" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Now you have effectively activated the <strong>ZTNA</strong> approach.</p>
</section>
</section>
</section>
<section id="test-the-modified-rule">
<h2>5.3 Test the modified rule<a class="headerlink" href="#test-the-modified-rule" title="Link to this heading">#</a></h2>
<p>Go to <strong>CoPilot &gt; Security &gt; Distributed Cloud Firewall &gt; Monitor</strong> and turn on the toggle <strong><em>Auto Refresh</em></strong>.</p>
<figure class="align-center" id="id41">
<a class="reference internal image-reference" href="../_images/lab6-defaultdenyall06.png"><img alt="../_images/lab6-defaultdenyall06.png" src="../_images/lab6-defaultdenyall06.png" style="height: 200px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 210 </span><span class="caption-text">Auto Refresh</span><a class="headerlink" href="#id41" title="Link to this image">#</a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>Now launch again the following curl commands from the instance <strong><em>aws-us-east2-spoke1-test2</em></strong>.</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>www.aviatrix.com
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>www.wikipedia.com
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>www.espn.com
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>www.football.com
</pre></div>
</div>
<p>Only the first two curl commands will be successful!</p>
<figure class="align-center" id="id42">
<img alt="../_images/lab6-newpic.png" src="../_images/lab6-newpic.png" />
<figcaption>
<p><span class="caption-number">Fig. 211 </span><span class="caption-text">Curl commands</span><a class="headerlink" href="#id42" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>You will notice almost instanteously that only <strong><em><a class="reference external" href="http://www.aviatrix.com">www.aviatrix.com</a></em></strong> and <strong><em><a class="reference external" href="http://www.wikipedia.com">www.wikipedia.com</a></em></strong> are allowed. Traffic towards <strong><em><a class="reference external" href="http://www.espn.com">www.espn.com</a></em></strong> and <strong><em><a class="reference external" href="http://www.football.com">www.football.com</a></em></strong> will be immediately dropped.</p>
<figure class="align-center" id="id43">
<a class="reference internal image-reference" href="../_images/lab6-liveview.png"><img alt="../_images/lab6-liveview.png" src="../_images/lab6-liveview.png" style="height: 250px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 212 </span><span class="caption-text">Permit</span><a class="headerlink" href="#id43" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="ids">
<h2>6. IDS<a class="headerlink" href="#ids" title="Link to this heading">#</a></h2>
<section id="id1">
<h3>6.1 Create a New Rule<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>Let’s now test the <strong><em>IDS</em></strong> feature (i.e. Intrusion Detection System), from the <strong>aws-us-east-2spoke1-test2</strong> instance.</p>
<p>Go to <strong>CoPilot &gt; Security &gt; Distributed Cloud Firewall &gt; Rules</strong> and click on the <code class="docutils literal notranslate"><span class="pre">&quot;+</span> <span class="pre">Rule&quot;</span></code> button.</p>
<p>Create a new DCF Rule with the following parameters:</p>
<ul class="simple">
<li><p><strong>Name</strong>: <span style='color:#479608'>Inspect-DNS</span></p></li>
<li><p><strong>Source Smartgroups</strong>: <span style='color:#479608'>us-east-2-private-subnet</span></p></li>
<li><p><strong>Destination Smartgroups</strong>: <span style='color:#479608'>Public Internet</span></p></li>
<li><p><strong>Protocol</strong>: <span style='color:#479608'>Any</span></p></li>
<li><p><strong>Logging</strong>: <span style='color:#479608'>On</span></p></li>
<li><p><strong>Action</strong>: <span style='color:#479608'><strong>Permit</strong></span></p></li>
<li><p><strong>Intrusion Detection (IDS)</strong>: <span style='color:#479608'><strong>On</strong></span></p></li>
</ul>
<p>Do not forget to click on <strong>Save In Drafts</strong>.</p>
<figure class="align-center" id="id44">
<img alt="../_images/lab6-ids.png" src="../_images/lab6-ids.png" />
<figcaption>
<p><span class="caption-number">Fig. 213 </span><span class="caption-text">Inspect-DNS</span><a class="headerlink" href="#id44" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Proceed clicking on the <strong>Commit</strong> button.</p>
<figure class="align-center" id="id45">
<a class="reference internal image-reference" href="../_images/lab6-idscommit.png"><img alt="../_images/lab6-idscommit.png" src="../_images/lab6-idscommit.png" style="height: 250px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 214 </span><span class="caption-text">New DCF List</span><a class="headerlink" href="#id45" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="prepare-the-simulator">
<h3>6.2 Prepare the simulator<a class="headerlink" href="#prepare-the-simulator" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>From the <strong><em>aws-us-east-2-spoke1-test2</em></strong> instance, launch the following <strong>two</strong> commands.</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>su<span class="w"> </span>-
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You will be asked to type again the student password!</p>
<figure class="align-center" id="id46">
<img alt="../_images/lab6-password.png" src="../_images/lab6-password.png" />
<figcaption>
<p><span class="caption-number">Fig. 215 </span><span class="caption-text">Root PWD</span><a class="headerlink" href="#id46" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>-sSL<span class="w"> </span>https://raw.githubusercontent.com/0xtf/testmynids.org/master/tmNIDS<span class="w"> </span>-o<span class="w"> </span>/tmp/tmNIDS<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>chmod<span class="w"> </span>+x<span class="w"> </span>/tmp/tmNIDS<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>/tmp/tmNIDS
</pre></div>
</div>
<figure class="align-center" id="id47">
<img alt="../_images/lab6-sudo.png" src="../_images/lab6-sudo.png" />
<figcaption>
<p><span class="caption-number">Fig. 216 </span><span class="caption-text">Commands issued</span><a class="headerlink" href="#id47" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The last command will show up a <strong><em>simulator</em></strong> from whom you will be able to launch an attack for testing the <code class="docutils literal notranslate"><span class="pre">&quot;Suricata</span> <span class="pre">IDS&quot;</span></code>.</p>
<figure class="align-center" id="id48">
<img alt="../_images/lab6-suricata.png" src="../_images/lab6-suricata.png" />
<figcaption>
<p><span class="caption-number">Fig. 217 </span><span class="caption-text">Simulator</span><a class="headerlink" href="#id48" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="test-the-new-rule-and-the-ids-feature">
<h3>6.3 Test the New Rule and the IDS feature<a class="headerlink" href="#test-the-new-rule-and-the-ids-feature" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Before launching the attack, edit the new DCF rule, clicking on the pencil icon beside the <strong><em>Inspect-DNS</em></strong> rule.</p></li>
</ul>
<figure class="align-center" id="id49">
<a class="reference internal image-reference" href="../_images/lab6-suricataedit.png"><img alt="../_images/lab6-suricataedit.png" src="../_images/lab6-suricataedit.png" style="height: 250px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 218 </span><span class="caption-text">Edit existing rule</span><a class="headerlink" href="#id49" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Insert the following parameters and do not forget to click on <strong>Save In Drafts</strong>:</p>
<ul class="simple">
<li><p><strong>Protocol</strong>: <span style='color:#479608'>UDP</span></p></li>
<li><p><strong>Port</strong>: <span style='color:#479608'>53</span></p></li>
</ul>
<figure class="align-center" id="id50">
<img alt="../_images/lab6-dns.png" src="../_images/lab6-dns.png" />
<figcaption>
<p><span class="caption-number">Fig. 219 </span><span class="caption-text">Modify the rule</span><a class="headerlink" href="#id50" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Now click on the <strong>Commit</strong> button.</p>
<figure class="align-center" id="id51">
<a class="reference internal image-reference" href="../_images/lab6-commit3.png"><img alt="../_images/lab6-commit3.png" src="../_images/lab6-commit3.png" style="height: 250px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 220 </span><span class="caption-text">Commit</span><a class="headerlink" href="#id51" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>From the EC2 instance <strong><em>aws-us-east-2-spoke1-test2</em></strong>, type <strong>5</strong> and click enter for launching a malicious attack, specifically the attack will try to establish a connection towards a TOR server.</p>
<figure class="align-center" id="id52">
<img alt="../_images/lab6-5.png" src="../_images/lab6-5.png" />
<figcaption>
<p><span class="caption-number">Fig. 221 </span><span class="caption-text">Malicious known attack</span><a class="headerlink" href="#id52" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Now go to <strong>CoPilot &gt; Security &gt; Distributed Cloud Firewall &gt; Detected Intrusions</strong>, and you will be able to find indicators that detected that attempt to contact a TOR server, through a DNS request.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you do not see the logs immediately, click on the <strong>refresh</strong> button</p>
</div>
<figure class="align-center" id="id53">
<a class="reference internal image-reference" href="../_images/lab6-refresh.png"><img alt="../_images/lab6-refresh.png" src="../_images/lab6-refresh.png" style="height: 150px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 222 </span><span class="caption-text">Detected Intrusions</span><a class="headerlink" href="#id53" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Click on any <strong>Timestamps</strong> to get additional insight on that specific attack.</p>
<figure class="align-center" id="id54">
<a class="reference internal image-reference" href="../_images/lab6-final.png"><img alt="../_images/lab6-final.png" src="../_images/lab6-final.png" style="height: 300px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 223 </span><span class="caption-text">Additional insights</span><a class="headerlink" href="#id54" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The indicator is showing clearly that you tried reaching out to Google DNS and then querying for a <strong>TOR</strong> domain!</p>
</div>
<p>After this lab, this is how the overall topology would look like:</p>
<figure class="align-center" id="id55">
<a class="reference internal image-reference" href="../_images/lab6-finaltopo.png"><img alt="../_images/lab6-finaltopo.png" src="../_images/lab6-finaltopo.png" style="height: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 224 </span><span class="caption-text">Final Topology for Lab 5</span><a class="headerlink" href="#id55" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>At the end of this lab <ins>the <strong>East-West traffic</strong> wll be blocked</ins>, due to the current configuration of the Distributed Cloud Firewall!</p>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./docs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="lab4.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Lab 4 - HPE WITH ACTIVE MESH</p>
      </div>
    </a>
    <a class="right-next"
       href="lab6.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Lab 6 - FIRENET</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#objective">1. Objective</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#topology">2. Topology</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ssh-to-the-ec2-instance-in-the-private-subnet">3. SSH to the EC2 instance in the Private Subnet</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#egress-control">4. Egress Control</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#enable-the-egress-control">4.1 Enable the Egress Control</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-the-private-rtb">4.2 Inspect the Private RTB</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-traffic">4.3 Generate Traffic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#enable-dcf">4.4 Enable DCF</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#identify-the-subnet-where-the-private-workload-resides">4.4.1 Identify the subnet where the private workload resides</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#create-an-ad-hoc-smartgroup">4.4.2 Create an Ad-Hoc SmartGroup</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-new-rule">4.4.3 Create a new Rule</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ztna-zero-trust-network-architecture">5. ZTNA - Zero Trust Network Architecture</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-new-webgroup">5.1 Create a New WebGroup</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-an-editable-explicit-deny-rule">5.2 Create an <em>“editable”</em> Explicit -Deny-Rule</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#enforce-the-egress-rule">5.2.1 Enforce the Egress-Rule</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#create-an-ad-hoc-explicit-deny-rule">5.2.2 Create an <em>ad-hoc</em> Explicit-Deny-Rule</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#test-the-modified-rule">5.3 Test the modified rule</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ids">6. IDS</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">6.1 Create a New Rule</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prepare-the-simulator">6.2 Prepare the simulator</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#test-the-new-rule-and-the-ids-feature">6.3 Test the New Rule and the IDS feature</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Aviatrix ACE
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>